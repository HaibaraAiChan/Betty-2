main start at this time 1675982526.0726342
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
EPOCH:  0
group buckets input  18164

current graph nodes  848910
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)

degs = graph.in_degrees() time :  0.00034928321838378906
nodes = graph.dstnodes() time :  4.4345855712890625e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.814697265625e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.0004222393035888672
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08515596389770508
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0007519721984863281
bucketing time:  0.0865020751953125
len node_bkt:  173
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0003559589385986328
assert len(eid_bkt) == deg * len(node_bkt):  9.775161743164062e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  7.939338684082031e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  2.47955322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  5.1975250244140625e-05
eid_bkt generation:  0.0004899501800537109
msgdata_bkt = msgdata.subframe(eid_bkt):  2.7418136596679688e-05
msgdata_bkt generation:  0.0005173683166503906
msgdata_bkt for loop:  0.0001761913299560547
NodeBatch generation:  9.059906005859375e-06
func(nbatch):  0.0032842159271240234
len node_bkt:  221
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0003018379211425781
assert len(eid_bkt) == deg * len(node_bkt):  7.3909759521484375e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.7418136596679688e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.5974044799804688e-05
ndata_bkt = dstdata.subframe(node_bkt):  4.0531158447265625e-05
eid_bkt generation:  0.0003650188446044922
msgdata_bkt = msgdata.subframe(eid_bkt):  2.0503997802734375e-05
msgdata_bkt generation:  0.00038552284240722656
msgdata_bkt for loop:  0.000110626220703125
NodeBatch generation:  5.245208740234375e-06
func(nbatch):  0.0004839897155761719
len node_bkt:  374
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00022649765014648438
assert len(eid_bkt) == deg * len(node_bkt):  5.9604644775390625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.193450927734375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0728836059570312e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.075599670410156e-05
eid_bkt generation:  0.00027680397033691406
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9550323486328125e-05
msgdata_bkt generation:  0.0002963542938232422
msgdata_bkt for loop:  9.584426879882812e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0009160041809082031
len node_bkt:  456
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002193450927734375
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.1457672119140625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.049041748046875e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0040740966796875e-05
eid_bkt generation:  0.00026869773864746094
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.0002875328063964844
msgdata_bkt for loop:  9.226799011230469e-05
NodeBatch generation:  1.33514404296875e-05
func(nbatch):  0.0029382705688476562
len node_bkt:  445
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021982192993164062
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.193450927734375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.049041748046875e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0279159545898438e-05
eid_bkt generation:  0.0002696514129638672
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.0002884864807128906
msgdata_bkt for loop:  9.369850158691406e-05
NodeBatch generation:  1.2874603271484375e-05
func(nbatch):  0.0015342235565185547
len node_bkt:  550
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002186298370361328
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.574920654296875e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0967254638671875e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0994415283203125e-05
eid_bkt generation:  0.00027370452880859375
msgdata_bkt = msgdata.subframe(eid_bkt):  2.002716064453125e-05
msgdata_bkt generation:  0.000293731689453125
msgdata_bkt for loop:  0.00010418891906738281
NodeBatch generation:  3.337860107421875e-06
func(nbatch):  0.001743316650390625
len node_bkt:  655
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00022149085998535156
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.8848648071289062e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0728836059570312e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0994415283203125e-05
eid_bkt generation:  0.00027871131896972656
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.00029754638671875
msgdata_bkt for loop:  0.00010609626770019531
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.0022928714752197266
len node_bkt:  512
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002205371856689453
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  3.528594970703125e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.049041748046875e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.147125244140625e-05
eid_bkt generation:  0.0002830028533935547
msgdata_bkt = msgdata.subframe(eid_bkt):  1.811981201171875e-05
msgdata_bkt generation:  0.00030112266540527344
msgdata_bkt for loop:  9.131431579589844e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0022382736206054688
len node_bkt:  576
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00022149085998535156
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.8848648071289062e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.049041748046875e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.075599670410156e-05
eid_bkt generation:  0.000278472900390625
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.0002970695495605469
msgdata_bkt for loop:  0.00010704994201660156
NodeBatch generation:  3.337860107421875e-06
func(nbatch):  0.002543210983276367
----NodeBatch generation time:  0.022705554962158203
----Frame generation time:  1.0967254638671875e-05
---- merge nodes time:  0.0006356239318847656
invoke_udf_reduce time:  0.11586880683898926
preparing time:  0.23548030853271484
model forward time:  0.11843156814575195
loss calculation time:  0.0001628398895263672
partial loss calculation time:  0.0006389617919921875
loss backward time:  0.01992058753967285

current graph nodes  848910
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0003275871276855469
nodes = graph.dstnodes() time :  8.535385131835938e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  9.298324584960938e-06
msgdata = Frame(msgdata) time :  9.5367431640625e-07
get ready time :  0.00047278404235839844
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.09021854400634766
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010514259338378906
tmp = F.gather_row(idx, eqidx)  2.6941299438476562e-05
N = math.ceil(len(tmp)/num_split)  1.1205673217773438e-05
unique_val = np.asarray(list([degree.item()]))  4.220008850097656e-05
step:  0
bucketing time:  0.09092569351196289
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007419586181640625
assert len(eid_bkt) == deg * len(node_bkt):  1.6927719116210938e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011641979217529297
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00024819374084472656
ndata_bkt = dstdata.subframe(node_bkt):  5.2928924560546875e-05
eid_bkt generation:  0.002188444137573242
msgdata_bkt = msgdata.subframe(eid_bkt):  3.910064697265625e-05
msgdata_bkt generation:  0.0022275447845458984
msgdata_bkt for loop:  0.0010707378387451172
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.009219646453857422
----NodeBatch generation time:  0.012646198272705078
----Frame generation time:  1.3113021850585938e-05
---- merge nodes time:  0.0001742839813232422
invoke_udf_reduce time:  0.10472512245178223

current graph nodes  848910
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0001583099365234375
nodes = graph.dstnodes() time :  2.8848648071289062e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.337860107421875e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00021314620971679688
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08275008201599121
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010800361633300781
tmp = F.gather_row(idx, eqidx)  2.7179718017578125e-05
N = math.ceil(len(tmp)/num_split)  1.2636184692382812e-05
unique_val = np.asarray(list([degree.item()]))  3.170967102050781e-05
step:  1
bucketing time:  0.08347225189208984
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007410049438476562
assert len(eid_bkt) == deg * len(node_bkt):  1.4543533325195312e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011453628540039062
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0003330707550048828
ndata_bkt = dstdata.subframe(node_bkt):  5.14984130859375e-05
eid_bkt generation:  0.0022509098052978516
msgdata_bkt = msgdata.subframe(eid_bkt):  3.814697265625e-05
msgdata_bkt generation:  0.0022890567779541016
msgdata_bkt for loop:  0.0006196498870849609
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.0013370513916015625
----NodeBatch generation time:  0.00438237190246582
----Frame generation time:  1.2636184692382812e-05
---- merge nodes time:  0.00016498565673828125
invoke_udf_reduce time:  0.08843135833740234

current graph nodes  848910
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0001659393310546875
nodes = graph.dstnodes() time :  2.9802322387695312e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.337860107421875e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00022363662719726562
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08475255966186523
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010395050048828125
tmp = F.gather_row(idx, eqidx)  2.5987625122070312e-05
N = math.ceil(len(tmp)/num_split)  1.1682510375976562e-05
unique_val = np.asarray(list([degree.item()]))  3.2901763916015625e-05
step:  2
bucketing time:  0.0854482650756836
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007498264312744141
assert len(eid_bkt) == deg * len(node_bkt):  1.5735626220703125e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0012943744659423828
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00028896331787109375
ndata_bkt = dstdata.subframe(node_bkt):  5.221366882324219e-05
eid_bkt generation:  0.0023658275604248047
msgdata_bkt = msgdata.subframe(eid_bkt):  4.124641418457031e-05
msgdata_bkt generation:  0.002407073974609375
msgdata_bkt for loop:  0.0006330013275146484
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.0008428096771240234
----NodeBatch generation time:  0.004007577896118164
----Frame generation time:  1.0728836059570312e-05
---- merge nodes time:  0.00016570091247558594
invoke_udf_reduce time:  0.09006094932556152

current graph nodes  848910
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00016450881958007812
nodes = graph.dstnodes() time :  2.9802322387695312e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.337860107421875e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00022149085998535156
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.0837557315826416
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010633468627929688
tmp = F.gather_row(idx, eqidx)  3.075599670410156e-05
N = math.ceil(len(tmp)/num_split)  1.239776611328125e-05
unique_val = np.asarray(list([degree.item()]))  3.0517578125e-05
step:  3
bucketing time:  0.08446860313415527
len node_bkt:  48150
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007379055023193359
assert len(eid_bkt) == deg * len(node_bkt):  1.5497207641601562e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011050701141357422
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0003268718719482422
ndata_bkt = dstdata.subframe(node_bkt):  5.245208740234375e-05
eid_bkt generation:  0.0022034645080566406
msgdata_bkt = msgdata.subframe(eid_bkt):  4.00543212890625e-05
msgdata_bkt generation:  0.002243518829345703
msgdata_bkt for loop:  0.0006225109100341797
NodeBatch generation:  4.76837158203125e-06
func(nbatch):  0.0008323192596435547
----NodeBatch generation time:  0.003823518753051758
----Frame generation time:  1.1682510375976562e-05
---- merge nodes time:  0.00017452239990234375
invoke_udf_reduce time:  0.08890652656555176
split  buckets total input  1442210
preparing time:  0.0740807056427002
model forward time :  0.3769407272338867
model forward time + loss calculation time:  0.37739086151123047
loss backward time:  0.019048690795898438
-------------------------------------------------------------------------------loss_sum  :  tensor(4.7918)

EPOCH:  1
group buckets input  18164

current graph nodes  848027
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)

degs = graph.in_degrees() time :  0.00016164779663085938
nodes = graph.dstnodes() time :  3.1948089599609375e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  4.5299530029296875e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.0002238750457763672
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08672928810119629
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0007610321044921875
bucketing time:  0.08800792694091797
len node_bkt:  173
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0003516674041748047
assert len(eid_bkt) == deg * len(node_bkt):  1.0013580322265625e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  3.266334533691406e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.9550323486328125e-05
ndata_bkt = dstdata.subframe(node_bkt):  5.1021575927734375e-05
eid_bkt generation:  0.00043511390686035156
msgdata_bkt = msgdata.subframe(eid_bkt):  2.7179718017578125e-05
msgdata_bkt generation:  0.0004622936248779297
msgdata_bkt for loop:  0.00013780593872070312
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0003731250762939453
len node_bkt:  221
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002567768096923828
assert len(eid_bkt) == deg * len(node_bkt):  6.9141387939453125e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.5272369384765625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.3589859008789062e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.910064697265625e-05
eid_bkt generation:  0.0003745555877685547
msgdata_bkt = msgdata.subframe(eid_bkt):  2.288818359375e-05
msgdata_bkt generation:  0.0003974437713623047
msgdata_bkt for loop:  0.0001220703125
NodeBatch generation:  5.245208740234375e-06
func(nbatch):  0.00030803680419921875
len node_bkt:  374
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.000225067138671875
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.0503997802734375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0279159545898438e-05
eid_bkt generation:  0.0002741813659667969
msgdata_bkt = msgdata.subframe(eid_bkt):  1.811981201171875e-05
msgdata_bkt generation:  0.0002923011779785156
msgdata_bkt for loop:  9.489059448242188e-05
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0003032684326171875
len node_bkt:  456
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021529197692871094
assert len(eid_bkt) == deg * len(node_bkt):  6.9141387939453125e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.1219253540039062e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.956390380859375e-05
eid_bkt generation:  0.0002651214599609375
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9073486328125e-05
msgdata_bkt generation:  0.0002841949462890625
msgdata_bkt for loop:  9.059906005859375e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0003466606140136719
len node_bkt:  445
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021338462829589844
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.2172927856445312e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0279159545898438e-05
eid_bkt generation:  0.000263214111328125
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8358230590820312e-05
msgdata_bkt generation:  0.0002815723419189453
msgdata_bkt for loop:  9.179115295410156e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0003769397735595703
len node_bkt:  550
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021409988403320312
assert len(eid_bkt) == deg * len(node_bkt):  6.67572021484375e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.4557113647460938e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.00026679039001464844
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.0002856254577636719
msgdata_bkt for loop:  9.34600830078125e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0004138946533203125
len node_bkt:  655
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021958351135253906
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.5987625122070312e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.0002727508544921875
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.00029158592224121094
msgdata_bkt for loop:  9.512901306152344e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.00045752525329589844
len node_bkt:  512
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021767616271972656
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.47955322265625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9325485229492188e-05
eid_bkt generation:  0.00026988983154296875
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.0002887248992919922
msgdata_bkt for loop:  9.5367431640625e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.0004954338073730469
len node_bkt:  576
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00023031234741210938
assert len(eid_bkt) == deg * len(node_bkt):  6.67572021484375e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.8133392333984375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0728836059570312e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.0002872943878173828
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9311904907226562e-05
msgdata_bkt generation:  0.0003066062927246094
msgdata_bkt for loop:  9.799003601074219e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.0005550384521484375
----NodeBatch generation time:  0.008181333541870117
----Frame generation time:  1.0251998901367188e-05
---- merge nodes time:  0.00016570091247558594
invoke_udf_reduce time:  0.10221600532531738
preparing time:  0.024857521057128906
model forward time:  0.10435247421264648
loss calculation time:  6.604194641113281e-05
partial loss calculation time:  0.0009984970092773438
loss backward time:  0.01349496841430664

current graph nodes  848027
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0003254413604736328
nodes = graph.dstnodes() time :  8.320808410644531e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  9.298324584960938e-06
msgdata = Frame(msgdata) time :  7.152557373046875e-07
get ready time :  0.00046944618225097656
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.0910797119140625
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011658668518066406
tmp = F.gather_row(idx, eqidx)  2.6702880859375e-05
N = math.ceil(len(tmp)/num_split)  1.3113021850585938e-05
unique_val = np.asarray(list([degree.item()]))  3.1948089599609375e-05
step:  0
bucketing time:  0.09179162979125977
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008127689361572266
assert len(eid_bkt) == deg * len(node_bkt):  1.6450881958007812e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0015544891357421875
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002961158752441406
ndata_bkt = dstdata.subframe(node_bkt):  5.125999450683594e-05
eid_bkt generation:  0.0026993751525878906
msgdata_bkt = msgdata.subframe(eid_bkt):  4.267692565917969e-05
msgdata_bkt generation:  0.0027420520782470703
msgdata_bkt for loop:  0.0006299018859863281
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008578300476074219
----NodeBatch generation time:  0.004353761672973633
----Frame generation time:  1.2874603271484375e-05
---- merge nodes time:  0.00016546249389648438
invoke_udf_reduce time:  0.09712672233581543

current graph nodes  848027
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00018453598022460938
nodes = graph.dstnodes() time :  3.0279159545898438e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.337860107421875e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00024437904357910156
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08621573448181152
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010967254638671875
tmp = F.gather_row(idx, eqidx)  2.6226043701171875e-05
N = math.ceil(len(tmp)/num_split)  1.1682510375976562e-05
unique_val = np.asarray(list([degree.item()]))  3.0517578125e-05
step:  1
bucketing time:  0.0869283676147461
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008413791656494141
assert len(eid_bkt) == deg * len(node_bkt):  1.7404556274414062e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0013935565948486328
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0003209114074707031
ndata_bkt = dstdata.subframe(node_bkt):  5.245208740234375e-05
eid_bkt generation:  0.0025942325592041016
msgdata_bkt = msgdata.subframe(eid_bkt):  4.172325134277344e-05
msgdata_bkt generation:  0.002635955810546875
msgdata_bkt for loop:  0.0006301403045654297
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0008635520935058594
----NodeBatch generation time:  0.004319906234741211
----Frame generation time:  1.1920928955078125e-05
---- merge nodes time:  0.00016999244689941406
invoke_udf_reduce time:  0.0918893814086914

current graph nodes  848027
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00016927719116210938
nodes = graph.dstnodes() time :  2.9802322387695312e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.0994415283203125e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.0002281665802001953
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08542013168334961
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010561943054199219
tmp = F.gather_row(idx, eqidx)  2.6702880859375e-05
N = math.ceil(len(tmp)/num_split)  1.1920928955078125e-05
unique_val = np.asarray(list([degree.item()]))  3.0040740966796875e-05
step:  2
bucketing time:  0.0861198902130127
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007505416870117188
assert len(eid_bkt) == deg * len(node_bkt):  1.5497207641601562e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0012698173522949219
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0003314018249511719
ndata_bkt = dstdata.subframe(node_bkt):  5.316734313964844e-05
eid_bkt generation:  0.002386331558227539
msgdata_bkt = msgdata.subframe(eid_bkt):  3.981590270996094e-05
msgdata_bkt generation:  0.0024261474609375
msgdata_bkt for loop:  0.0006268024444580078
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008482933044433594
----NodeBatch generation time:  0.004027128219604492
----Frame generation time:  1.1444091796875e-05
---- merge nodes time:  0.00016641616821289062
invoke_udf_reduce time:  0.09076142311096191

current graph nodes  848027
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00016260147094726562
nodes = graph.dstnodes() time :  3.886222839355469e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.814697265625e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.0002307891845703125
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08551573753356934
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010728836059570312
tmp = F.gather_row(idx, eqidx)  2.5987625122070312e-05
N = math.ceil(len(tmp)/num_split)  1.1444091796875e-05
unique_val = np.asarray(list([degree.item()]))  3.0994415283203125e-05
step:  3
bucketing time:  0.0862116813659668
len node_bkt:  48150
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007452964782714844
assert len(eid_bkt) == deg * len(node_bkt):  1.6450881958007812e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011470317840576172
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00023889541625976562
ndata_bkt = dstdata.subframe(node_bkt):  5.221366882324219e-05
eid_bkt generation:  0.002165079116821289
msgdata_bkt = msgdata.subframe(eid_bkt):  3.838539123535156e-05
msgdata_bkt generation:  0.0022034645080566406
msgdata_bkt for loop:  0.0006155967712402344
NodeBatch generation:  5.245208740234375e-06
func(nbatch):  0.0008323192596435547
----NodeBatch generation time:  0.0037789344787597656
----Frame generation time:  1.2159347534179688e-05
---- merge nodes time:  0.00016546249389648438
invoke_udf_reduce time:  0.09060907363891602
split  buckets total input  1440934
preparing time:  0.09042906761169434
model forward time :  0.37549352645874023
model forward time + loss calculation time:  0.37596583366394043
loss backward time:  0.02358388900756836
-------------------------------------------------------------------------------loss_sum  :  tensor(4.7273)

EPOCH:  2
group buckets input  18164

current graph nodes  848038
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)

degs = graph.in_degrees() time :  0.000164031982421875
nodes = graph.dstnodes() time :  2.86102294921875e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  4.76837158203125e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00022220611572265625
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.07698202133178711
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0007004737854003906
bucketing time:  0.07819437980651855
len node_bkt:  173
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00035452842712402344
assert len(eid_bkt) == deg * len(node_bkt):  1.0967254638671875e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  3.147125244140625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.9788742065429688e-05
ndata_bkt = dstdata.subframe(node_bkt):  5.245208740234375e-05
eid_bkt generation:  0.0004343986511230469
msgdata_bkt = msgdata.subframe(eid_bkt):  2.86102294921875e-05
msgdata_bkt generation:  0.0004630088806152344
msgdata_bkt for loop:  0.00013113021850585938
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.00036525726318359375
len node_bkt:  221
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002620220184326172
assert len(eid_bkt) == deg * len(node_bkt):  7.152557373046875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.6226043701171875e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.3828277587890625e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.790855407714844e-05
eid_bkt generation:  0.00032019615173339844
msgdata_bkt = msgdata.subframe(eid_bkt):  2.0742416381835938e-05
msgdata_bkt generation:  0.0003409385681152344
msgdata_bkt for loop:  0.00010728836059570312
NodeBatch generation:  5.9604644775390625e-06
func(nbatch):  0.0003139972686767578
len node_bkt:  374
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002224445343017578
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  3.123283386230469e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.1444091796875e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9325485229492188e-05
eid_bkt generation:  0.00028395652770996094
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9550323486328125e-05
msgdata_bkt generation:  0.00030350685119628906
msgdata_bkt for loop:  9.369850158691406e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.00030040740966796875
len node_bkt:  456
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021505355834960938
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.0742416381835938e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.86102294921875e-05
eid_bkt generation:  0.000263214111328125
msgdata_bkt = msgdata.subframe(eid_bkt):  1.7881393432617188e-05
msgdata_bkt generation:  0.0002810955047607422
msgdata_bkt for loop:  9.1552734375e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.00034165382385253906
len node_bkt:  445
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.000213623046875
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.193450927734375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.00032448768615722656
msgdata_bkt = msgdata.subframe(eid_bkt):  2.0503997802734375e-05
msgdata_bkt generation:  0.00034499168395996094
msgdata_bkt for loop:  0.00010228157043457031
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.000423431396484375
len node_bkt:  550
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021600723266601562
assert len(eid_bkt) == deg * len(node_bkt):  6.67572021484375e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.4557113647460938e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0279159545898438e-05
eid_bkt generation:  0.0002689361572265625
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.0002875328063964844
msgdata_bkt for loop:  9.441375732421875e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.00042366981506347656
len node_bkt:  655
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00022125244140625
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.765655517578125e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9325485229492188e-05
eid_bkt generation:  0.00027680397033691406
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.0002956390380859375
msgdata_bkt for loop:  9.679794311523438e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.00048279762268066406
len node_bkt:  512
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021600723266601562
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.47955322265625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.695487976074219e-05
eid_bkt generation:  0.00026869773864746094
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8358230590820312e-05
msgdata_bkt generation:  0.00028705596923828125
msgdata_bkt for loop:  9.608268737792969e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0005095005035400391
len node_bkt:  576
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.000217437744140625
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.8848648071289062e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0517578125e-05
eid_bkt generation:  0.0002734661102294922
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.0002923011779785156
msgdata_bkt for loop:  9.703636169433594e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0005512237548828125
----NodeBatch generation time:  0.008263587951660156
----Frame generation time:  1.0251998901367188e-05
---- merge nodes time:  0.00015783309936523438
invoke_udf_reduce time:  0.09252572059631348
preparing time:  0.02319192886352539
model forward time:  0.09347200393676758
loss calculation time:  6.246566772460938e-05
partial loss calculation time:  0.0010159015655517578
loss backward time:  0.017855167388916016

current graph nodes  848038
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0003643035888671875
nodes = graph.dstnodes() time :  9.1552734375e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  9.5367431640625e-06
msgdata = Frame(msgdata) time :  7.152557373046875e-07
get ready time :  0.0005216598510742188
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.09353160858154297
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010657310485839844
tmp = F.gather_row(idx, eqidx)  2.7418136596679688e-05
N = math.ceil(len(tmp)/num_split)  1.1205673217773438e-05
unique_val = np.asarray(list([degree.item()]))  3.170967102050781e-05
step:  0
bucketing time:  0.09423398971557617
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.001293182373046875
assert len(eid_bkt) == deg * len(node_bkt):  1.7881393432617188e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0012683868408203125
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0005068778991699219
ndata_bkt = dstdata.subframe(node_bkt):  5.173683166503906e-05
eid_bkt generation:  0.003106355667114258
msgdata_bkt = msgdata.subframe(eid_bkt):  4.410743713378906e-05
msgdata_bkt generation:  0.003150463104248047
msgdata_bkt for loop:  0.0006353855133056641
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0008399486541748047
----NodeBatch generation time:  0.004751443862915039
----Frame generation time:  1.1920928955078125e-05
---- merge nodes time:  0.00016951560974121094
invoke_udf_reduce time:  0.10004949569702148

current graph nodes  848038
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00016641616821289062
nodes = graph.dstnodes() time :  3.0279159545898438e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.5762786865234375e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00022554397583007812
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08606266975402832
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010442733764648438
tmp = F.gather_row(idx, eqidx)  2.6226043701171875e-05
N = math.ceil(len(tmp)/num_split)  1.1205673217773438e-05
unique_val = np.asarray(list([degree.item()]))  4.220008850097656e-05
step:  1
bucketing time:  0.08677339553833008
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008182525634765625
assert len(eid_bkt) == deg * len(node_bkt):  1.7404556274414062e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0012619495391845703
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0003218650817871094
ndata_bkt = dstdata.subframe(node_bkt):  5.340576171875e-05
eid_bkt generation:  0.0024390220642089844
msgdata_bkt = msgdata.subframe(eid_bkt):  4.220008850097656e-05
msgdata_bkt generation:  0.002481222152709961
msgdata_bkt for loop:  0.0006229877471923828
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008420944213867188
----NodeBatch generation time:  0.004074811935424805
----Frame generation time:  1.2159347534179688e-05
---- merge nodes time:  0.0001652240753173828
invoke_udf_reduce time:  0.09146356582641602

current graph nodes  848038
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00017380714416503906
nodes = graph.dstnodes() time :  2.956390380859375e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.337860107421875e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00023484230041503906
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.0847930908203125
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010561943054199219
tmp = F.gather_row(idx, eqidx)  2.6464462280273438e-05
N = math.ceil(len(tmp)/num_split)  1.1444091796875e-05
unique_val = np.asarray(list([degree.item()]))  3.218650817871094e-05
step:  2
bucketing time:  0.08548879623413086
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008304119110107422
assert len(eid_bkt) == deg * len(node_bkt):  1.8596649169921875e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0012688636779785156
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0003304481506347656
ndata_bkt = dstdata.subframe(node_bkt):  5.2928924560546875e-05
eid_bkt generation:  0.0024673938751220703
msgdata_bkt = msgdata.subframe(eid_bkt):  4.315376281738281e-05
msgdata_bkt generation:  0.002510547637939453
msgdata_bkt for loop:  0.0006270408630371094
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0008451938629150391
----NodeBatch generation time:  0.004174470901489258
----Frame generation time:  1.3113021850585938e-05
---- merge nodes time:  0.00018167495727539062
invoke_udf_reduce time:  0.0903010368347168

current graph nodes  848038
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00016617774963378906
nodes = graph.dstnodes() time :  2.9802322387695312e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.5762786865234375e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00022363662719726562
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08527350425720215
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0001068115234375
tmp = F.gather_row(idx, eqidx)  2.6226043701171875e-05
N = math.ceil(len(tmp)/num_split)  1.049041748046875e-05
unique_val = np.asarray(list([degree.item()]))  3.147125244140625e-05
step:  3
bucketing time:  0.08597278594970703
len node_bkt:  48150
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007431507110595703
assert len(eid_bkt) == deg * len(node_bkt):  1.5497207641601562e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0012159347534179688
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002856254577636719
ndata_bkt = dstdata.subframe(node_bkt):  5.364418029785156e-05
eid_bkt generation:  0.002279520034790039
msgdata_bkt = msgdata.subframe(eid_bkt):  3.838539123535156e-05
msgdata_bkt generation:  0.0023179054260253906
msgdata_bkt for loop:  0.0006191730499267578
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008556842803955078
----NodeBatch generation time:  0.003920793533325195
----Frame generation time:  1.2159347534179688e-05
---- merge nodes time:  0.00016689300537109375
invoke_udf_reduce time:  0.0904991626739502
split  buckets total input  1441351
preparing time:  0.08370828628540039
model forward time :  0.37751054763793945
model forward time + loss calculation time:  0.37796783447265625
loss backward time:  0.021116256713867188
-------------------------------------------------------------------------------loss_sum  :  tensor(4.6635)

EPOCH:  3
full batch graph loading time:  0.0586550235748291
group buckets input  18164

current graph nodes  848349
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)

degs = graph.in_degrees() time :  0.00016379356384277344
nodes = graph.dstnodes() time :  2.8371810913085938e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  4.5299530029296875e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00022220611572265625
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.07805728912353516
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006802082061767578
bucketing time:  0.07925200462341309
len node_bkt:  173
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00035119056701660156
assert len(eid_bkt) == deg * len(node_bkt):  1.049041748046875e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  3.0517578125e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.9073486328125e-05
ndata_bkt = dstdata.subframe(node_bkt):  5.316734313964844e-05
eid_bkt generation:  0.0004343986511230469
msgdata_bkt = msgdata.subframe(eid_bkt):  2.7418136596679688e-05
msgdata_bkt generation:  0.00046181678771972656
msgdata_bkt for loop:  0.00013184547424316406
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0003609657287597656
len node_bkt:  221
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002655982971191406
assert len(eid_bkt) == deg * len(node_bkt):  6.67572021484375e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.6702880859375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.2636184692382812e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.647804260253906e-05
eid_bkt generation:  0.0003228187561035156
msgdata_bkt = msgdata.subframe(eid_bkt):  2.0265579223632812e-05
msgdata_bkt generation:  0.00034308433532714844
msgdata_bkt for loop:  0.00010585784912109375
NodeBatch generation:  5.7220458984375e-06
func(nbatch):  0.0003056526184082031
len node_bkt:  374
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002281665802001953
assert len(eid_bkt) == deg * len(node_bkt):  6.9141387939453125e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  1.9550323486328125e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.956390380859375e-05
eid_bkt generation:  0.0002753734588623047
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8358230590820312e-05
msgdata_bkt generation:  0.000293731689453125
msgdata_bkt for loop:  8.96453857421875e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0002956390380859375
len node_bkt:  456
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021886825561523438
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.0503997802734375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  9.5367431640625e-06
ndata_bkt = dstdata.subframe(node_bkt):  2.9087066650390625e-05
eid_bkt generation:  0.00026607513427734375
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.0002849102020263672
msgdata_bkt for loop:  9.059906005859375e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.00034356117248535156
len node_bkt:  445
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.000213623046875
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.1696090698242188e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  9.775161743164062e-06
ndata_bkt = dstdata.subframe(node_bkt):  3.0279159545898438e-05
eid_bkt generation:  0.00026345252990722656
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.00028228759765625
msgdata_bkt for loop:  9.202957153320312e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.00038361549377441406
len node_bkt:  550
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002143383026123047
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.4318695068359375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.0002658367156982422
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8358230590820312e-05
msgdata_bkt generation:  0.0002841949462890625
msgdata_bkt for loop:  9.322166442871094e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.00042557716369628906
len node_bkt:  655
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.000217437744140625
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.8133392333984375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.049041748046875e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.00027298927307128906
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.00029158592224121094
msgdata_bkt for loop:  9.679794311523438e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.00046896934509277344
len node_bkt:  512
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002205371856689453
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.5510787963867188e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.7670135498046875e-05
eid_bkt generation:  0.0003285408020019531
msgdata_bkt = msgdata.subframe(eid_bkt):  2.0265579223632812e-05
msgdata_bkt generation:  0.00034880638122558594
msgdata_bkt for loop:  0.00010418891906738281
NodeBatch generation:  4.76837158203125e-06
func(nbatch):  0.0005345344543457031
len node_bkt:  576
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021767616271972656
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.9802322387695312e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.2874603271484375e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.075599670410156e-05
eid_bkt generation:  0.0002791881561279297
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.0002980232238769531
msgdata_bkt for loop:  9.870529174804688e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0005462169647216797
----NodeBatch generation time:  0.008204936981201172
----Frame generation time:  1.0251998901367188e-05
---- merge nodes time:  0.00015807151794433594
invoke_udf_reduce time:  0.09351563453674316
preparing time:  0.020051002502441406
model forward time:  0.0944666862487793
loss calculation time:  6.246566772460938e-05
partial loss calculation time:  0.0010247230529785156
loss backward time:  0.009482622146606445

current graph nodes  848349
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0003268718719482422
nodes = graph.dstnodes() time :  8.368492126464844e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  9.059906005859375e-06
msgdata = Frame(msgdata) time :  9.5367431640625e-07
get ready time :  0.0004699230194091797
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.09156060218811035
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0001068115234375
tmp = F.gather_row(idx, eqidx)  2.5033950805664062e-05
N = math.ceil(len(tmp)/num_split)  1.1205673217773438e-05
unique_val = np.asarray(list([degree.item()]))  3.075599670410156e-05
step:  0
bucketing time:  0.0922553539276123
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008018016815185547
assert len(eid_bkt) == deg * len(node_bkt):  1.621246337890625e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011570453643798828
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00023436546325683594
ndata_bkt = dstdata.subframe(node_bkt):  5.245208740234375e-05
eid_bkt generation:  0.002228260040283203
msgdata_bkt = msgdata.subframe(eid_bkt):  4.029273986816406e-05
msgdata_bkt generation:  0.002268552780151367
msgdata_bkt for loop:  0.0006148815155029297
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.0008380413055419922
----NodeBatch generation time:  0.003846406936645508
----Frame generation time:  1.1682510375976562e-05
---- merge nodes time:  0.0001621246337890625
invoke_udf_reduce time:  0.097076416015625

current graph nodes  848349
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00015687942504882812
nodes = graph.dstnodes() time :  2.8848648071289062e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.337860107421875e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.0002110004425048828
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08497452735900879
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010442733764648438
tmp = F.gather_row(idx, eqidx)  2.7418136596679688e-05
N = math.ceil(len(tmp)/num_split)  1.1444091796875e-05
unique_val = np.asarray(list([degree.item()]))  3.147125244140625e-05
step:  1
bucketing time:  0.08566737174987793
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007431507110595703
assert len(eid_bkt) == deg * len(node_bkt):  1.71661376953125e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.001123189926147461
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002465248107910156
ndata_bkt = dstdata.subframe(node_bkt):  5.14984130859375e-05
eid_bkt generation:  0.0021469593048095703
msgdata_bkt = msgdata.subframe(eid_bkt):  3.886222839355469e-05
msgdata_bkt generation:  0.002185821533203125
msgdata_bkt for loop:  0.0006113052368164062
NodeBatch generation:  5.0067901611328125e-06
func(nbatch):  0.0008285045623779297
----NodeBatch generation time:  0.003751993179321289
----Frame generation time:  1.1920928955078125e-05
---- merge nodes time:  0.0001652240753173828
invoke_udf_reduce time:  0.08999872207641602

current graph nodes  848349
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00016427040100097656
nodes = graph.dstnodes() time :  2.86102294921875e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.0994415283203125e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00021839141845703125
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08477044105529785
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010657310485839844
tmp = F.gather_row(idx, eqidx)  2.5987625122070312e-05
N = math.ceil(len(tmp)/num_split)  1.1444091796875e-05
unique_val = np.asarray(list([degree.item()]))  3.170967102050781e-05
step:  2
bucketing time:  0.08546304702758789
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007467269897460938
assert len(eid_bkt) == deg * len(node_bkt):  1.5497207641601562e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011203289031982422
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002567768096923828
ndata_bkt = dstdata.subframe(node_bkt):  5.340576171875e-05
eid_bkt generation:  0.002157926559448242
msgdata_bkt = msgdata.subframe(eid_bkt):  3.910064697265625e-05
msgdata_bkt generation:  0.0021970272064208984
msgdata_bkt for loop:  0.0006127357482910156
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.0008482933044433594
----NodeBatch generation time:  0.0037827491760253906
----Frame generation time:  1.5735626220703125e-05
---- merge nodes time:  0.00016832351684570312
invoke_udf_reduce time:  0.08985400199890137

current graph nodes  848349
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0001583099365234375
nodes = graph.dstnodes() time :  2.7894973754882812e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.5762786865234375e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00021314620971679688
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08552861213684082
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010371208190917969
tmp = F.gather_row(idx, eqidx)  2.6941299438476562e-05
N = math.ceil(len(tmp)/num_split)  1.1682510375976562e-05
unique_val = np.asarray(list([degree.item()]))  3.170967102050781e-05
step:  3
bucketing time:  0.08621931076049805
len node_bkt:  48150
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007429122924804688
assert len(eid_bkt) == deg * len(node_bkt):  1.621246337890625e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011110305786132812
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002472400665283203
ndata_bkt = dstdata.subframe(node_bkt):  5.14984130859375e-05
eid_bkt generation:  0.0021347999572753906
msgdata_bkt = msgdata.subframe(eid_bkt):  3.814697265625e-05
msgdata_bkt generation:  0.0021729469299316406
msgdata_bkt for loop:  0.0006115436553955078
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0008440017700195312
----NodeBatch generation time:  0.003749847412109375
----Frame generation time:  1.2874603271484375e-05
---- merge nodes time:  0.0001647472381591797
invoke_udf_reduce time:  0.09055638313293457
split  buckets total input  1441871
preparing time:  0.08205962181091309
model forward time :  0.37211155891418457
model forward time + loss calculation time:  0.3725626468658447
loss backward time:  0.023641347885131836
-------------------------------------------------------------------------------loss_sum  :  tensor(4.5988)

pure train time 0.5002157688140869
EPOCH:  4
full batch graph loading time:  0.03956127166748047
group buckets input  18164

current graph nodes  848190
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)

degs = graph.in_degrees() time :  0.00016427040100097656
nodes = graph.dstnodes() time :  2.8133392333984375e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  4.76837158203125e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.0002200603485107422
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.077789306640625
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006875991821289062
bucketing time:  0.07902312278747559
len node_bkt:  173
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00036406517028808594
assert len(eid_bkt) == deg * len(node_bkt):  1.239776611328125e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  8.940696716308594e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  2.2411346435546875e-05
ndata_bkt = dstdata.subframe(node_bkt):  5.4836273193359375e-05
eid_bkt generation:  0.0005102157592773438
msgdata_bkt = msgdata.subframe(eid_bkt):  2.8848648071289062e-05
msgdata_bkt generation:  0.0005390644073486328
msgdata_bkt for loop:  0.00014591217041015625
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.00047326087951660156
len node_bkt:  221
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002779960632324219
assert len(eid_bkt) == deg * len(node_bkt):  7.152557373046875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.9087066650390625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.4066696166992188e-05
ndata_bkt = dstdata.subframe(node_bkt):  4.1484832763671875e-05
eid_bkt generation:  0.0003402233123779297
msgdata_bkt = msgdata.subframe(eid_bkt):  2.09808349609375e-05
msgdata_bkt generation:  0.0003612041473388672
msgdata_bkt for loop:  0.00011801719665527344
NodeBatch generation:  5.9604644775390625e-06
func(nbatch):  0.00029087066650390625
len node_bkt:  374
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.000225067138671875
assert len(eid_bkt) == deg * len(node_bkt):  6.9141387939453125e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.1457672119140625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0728836059570312e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.0002760887145996094
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.0002949237823486328
msgdata_bkt for loop:  9.441375732421875e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.00029921531677246094
len node_bkt:  456
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002193450927734375
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.1457672119140625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0279159545898438e-05
eid_bkt generation:  0.0002682209014892578
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.00028705596923828125
msgdata_bkt for loop:  9.226799011230469e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.0003452301025390625
len node_bkt:  445
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021338462829589844
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.2649765014648438e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0279159545898438e-05
eid_bkt generation:  0.0002624988555908203
msgdata_bkt = msgdata.subframe(eid_bkt):  1.811981201171875e-05
msgdata_bkt generation:  0.00028061866760253906
msgdata_bkt for loop:  9.179115295410156e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.00039005279541015625
len node_bkt:  550
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002148151397705078
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.4318695068359375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  9.5367431640625e-06
ndata_bkt = dstdata.subframe(node_bkt):  3.0040740966796875e-05
eid_bkt generation:  0.0002663135528564453
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9073486328125e-05
msgdata_bkt generation:  0.0002853870391845703
msgdata_bkt for loop:  9.298324584960938e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.0004329681396484375
len node_bkt:  655
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021696090698242188
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.7418136596679688e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.956390380859375e-05
eid_bkt generation:  0.0002715587615966797
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9073486328125e-05
msgdata_bkt generation:  0.0002906322479248047
msgdata_bkt for loop:  9.655952453613281e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0004665851593017578
len node_bkt:  512
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021719932556152344
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.5510787963867188e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0040740966796875e-05
eid_bkt generation:  0.0002701282501220703
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9073486328125e-05
msgdata_bkt generation:  0.0002892017364501953
msgdata_bkt for loop:  9.512901306152344e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.000507354736328125
len node_bkt:  576
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021839141845703125
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.9087066650390625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.049041748046875e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.00027489662170410156
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9073486328125e-05
msgdata_bkt generation:  0.00029397010803222656
msgdata_bkt for loop:  9.632110595703125e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.0005469322204589844
----NodeBatch generation time:  0.00834798812866211
----Frame generation time:  1.0013580322265625e-05
---- merge nodes time:  0.00019097328186035156
invoke_udf_reduce time:  0.09339737892150879
preparing time:  0.02002120018005371
model forward time:  0.09523463249206543
loss calculation time:  0.000110626220703125
partial loss calculation time:  0.0009183883666992188
loss backward time:  0.018461227416992188

current graph nodes  848190
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00032806396484375
nodes = graph.dstnodes() time :  8.606910705566406e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  9.5367431640625e-06
msgdata = Frame(msgdata) time :  9.5367431640625e-07
get ready time :  0.0004744529724121094
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.09242796897888184
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011134147644042969
tmp = F.gather_row(idx, eqidx)  3.886222839355469e-05
N = math.ceil(len(tmp)/num_split)  1.621246337890625e-05
unique_val = np.asarray(list([degree.item()]))  4.363059997558594e-05
step:  0
bucketing time:  0.09328246116638184
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008037090301513672
assert len(eid_bkt) == deg * len(node_bkt):  1.7642974853515625e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0013000965118408203
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002658367156982422
ndata_bkt = dstdata.subframe(node_bkt):  7.104873657226562e-05
eid_bkt generation:  0.0024051666259765625
msgdata_bkt = msgdata.subframe(eid_bkt):  4.3392181396484375e-05
msgdata_bkt generation:  0.002448558807373047
msgdata_bkt for loop:  0.0006690025329589844
NodeBatch generation:  5.9604644775390625e-06
func(nbatch):  0.0008676052093505859
----NodeBatch generation time:  0.0041544437408447266
----Frame generation time:  1.1205673217773438e-05
---- merge nodes time:  0.000179290771484375
invoke_udf_reduce time:  0.09842848777770996

current graph nodes  848190
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00018095970153808594
nodes = graph.dstnodes() time :  3.218650817871094e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.5762786865234375e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.0002410411834716797
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08518815040588379
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011515617370605469
tmp = F.gather_row(idx, eqidx)  2.6464462280273438e-05
N = math.ceil(len(tmp)/num_split)  1.1682510375976562e-05
unique_val = np.asarray(list([degree.item()]))  3.4809112548828125e-05
step:  1
bucketing time:  0.08594155311584473
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007622241973876953
assert len(eid_bkt) == deg * len(node_bkt):  1.621246337890625e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011289119720458984
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00025200843811035156
ndata_bkt = dstdata.subframe(node_bkt):  5.14984130859375e-05
eid_bkt generation:  0.002174854278564453
msgdata_bkt = msgdata.subframe(eid_bkt):  3.743171691894531e-05
msgdata_bkt generation:  0.0022122859954833984
msgdata_bkt for loop:  0.0006215572357177734
NodeBatch generation:  5.9604644775390625e-06
func(nbatch):  0.0008895397186279297
----NodeBatch generation time:  0.0038547515869140625
----Frame generation time:  1.2874603271484375e-05
---- merge nodes time:  0.00017642974853515625
invoke_udf_reduce time:  0.09058332443237305

current graph nodes  848190
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00016021728515625
nodes = graph.dstnodes() time :  2.86102294921875e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.0994415283203125e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.0002200603485107422
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08494114875793457
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010609626770019531
tmp = F.gather_row(idx, eqidx)  2.5510787963867188e-05
N = math.ceil(len(tmp)/num_split)  1.0251998901367188e-05
unique_val = np.asarray(list([degree.item()]))  3.170967102050781e-05
step:  2
bucketing time:  0.08563566207885742
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007407665252685547
assert len(eid_bkt) == deg * len(node_bkt):  1.71661376953125e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011551380157470703
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002536773681640625
ndata_bkt = dstdata.subframe(node_bkt):  5.316734313964844e-05
eid_bkt generation:  0.0021829605102539062
msgdata_bkt = msgdata.subframe(eid_bkt):  4.00543212890625e-05
msgdata_bkt generation:  0.0022230148315429688
msgdata_bkt for loop:  0.0006091594696044922
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.0008466243743896484
----NodeBatch generation time:  0.0038061141967773438
----Frame generation time:  1.1444091796875e-05
---- merge nodes time:  0.00016736984252929688
invoke_udf_reduce time:  0.09002041816711426

current graph nodes  848190
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0001571178436279297
nodes = graph.dstnodes() time :  2.8133392333984375e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.0994415283203125e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00021195411682128906
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08509945869445801
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010585784912109375
tmp = F.gather_row(idx, eqidx)  2.765655517578125e-05
N = math.ceil(len(tmp)/num_split)  1.1205673217773438e-05
unique_val = np.asarray(list([degree.item()]))  3.147125244140625e-05
step:  3
bucketing time:  0.08579730987548828
len node_bkt:  48150
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007545948028564453
assert len(eid_bkt) == deg * len(node_bkt):  1.52587890625e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011143684387207031
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0003006458282470703
ndata_bkt = dstdata.subframe(node_bkt):  5.412101745605469e-05
eid_bkt generation:  0.002202272415161133
msgdata_bkt = msgdata.subframe(eid_bkt):  4.1961669921875e-05
msgdata_bkt generation:  0.002244234085083008
msgdata_bkt for loop:  0.0006165504455566406
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008320808410644531
----NodeBatch generation time:  0.003818988800048828
----Frame generation time:  1.1205673217773438e-05
---- merge nodes time:  0.0001633167266845703
invoke_udf_reduce time:  0.09018826484680176
split  buckets total input  1441822
preparing time:  0.08259773254394531
model forward time :  0.3743870258331299
model forward time + loss calculation time:  0.37485384941101074
loss backward time:  0.021601438522338867
-------------------------------------------------------------------------------loss_sum  :  tensor(4.5354)

pure train time 0.5102617740631104
EPOCH:  5
full batch graph loading time:  0.04081583023071289
group buckets input  18164

current graph nodes  848325
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)

degs = graph.in_degrees() time :  0.0001647472381591797
nodes = graph.dstnodes() time :  2.9087066650390625e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  5.0067901611328125e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00022268295288085938
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.07903766632080078
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006849765777587891
bucketing time:  0.0802316665649414
len node_bkt:  173
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0003514289855957031
assert len(eid_bkt) == deg * len(node_bkt):  1.2874603271484375e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.9802322387695312e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.9788742065429688e-05
ndata_bkt = dstdata.subframe(node_bkt):  5.316734313964844e-05
eid_bkt generation:  0.0004360675811767578
msgdata_bkt = msgdata.subframe(eid_bkt):  3.123283386230469e-05
msgdata_bkt generation:  0.0004673004150390625
msgdata_bkt for loop:  0.00013184547424316406
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.00035381317138671875
len node_bkt:  221
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002837181091308594
assert len(eid_bkt) == deg * len(node_bkt):  6.67572021484375e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.4318695068359375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.3589859008789062e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.719329833984375e-05
eid_bkt generation:  0.0004010200500488281
msgdata_bkt = msgdata.subframe(eid_bkt):  2.2649765014648438e-05
msgdata_bkt generation:  0.00042366981506347656
msgdata_bkt for loop:  0.00012159347534179688
NodeBatch generation:  5.9604644775390625e-06
func(nbatch):  0.00029969215393066406
len node_bkt:  374
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00022554397583007812
assert len(eid_bkt) == deg * len(node_bkt):  5.9604644775390625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.0742416381835938e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.1682510375976562e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.0002753734588623047
msgdata_bkt = msgdata.subframe(eid_bkt):  1.811981201171875e-05
msgdata_bkt generation:  0.00029349327087402344
msgdata_bkt for loop:  9.1552734375e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0002963542938232422
len node_bkt:  456
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021696090698242188
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.09808349609375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9325485229492188e-05
eid_bkt generation:  0.0002663135528564453
msgdata_bkt = msgdata.subframe(eid_bkt):  1.811981201171875e-05
msgdata_bkt generation:  0.00028443336486816406
msgdata_bkt for loop:  9.250640869140625e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0003459453582763672
len node_bkt:  445
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002148151397705078
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.193450927734375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9325485229492188e-05
eid_bkt generation:  0.0002636909484863281
msgdata_bkt = msgdata.subframe(eid_bkt):  1.7881393432617188e-05
msgdata_bkt generation:  0.0002815723419189453
msgdata_bkt for loop:  9.131431579589844e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.00038313865661621094
len node_bkt:  550
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002155303955078125
assert len(eid_bkt) == deg * len(node_bkt):  6.67572021484375e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.47955322265625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9325485229492188e-05
eid_bkt generation:  0.0002675056457519531
msgdata_bkt = msgdata.subframe(eid_bkt):  1.811981201171875e-05
msgdata_bkt generation:  0.0002856254577636719
msgdata_bkt for loop:  9.34600830078125e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0004372596740722656
len node_bkt:  655
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021767616271972656
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.8133392333984375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0279159545898438e-05
eid_bkt generation:  0.0002739429473876953
msgdata_bkt = msgdata.subframe(eid_bkt):  1.7881393432617188e-05
msgdata_bkt generation:  0.0002918243408203125
msgdata_bkt for loop:  9.584426879882812e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.00046944618225097656
len node_bkt:  512
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002181529998779297
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.4557113647460938e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0279159545898438e-05
eid_bkt generation:  0.00026988983154296875
msgdata_bkt = msgdata.subframe(eid_bkt):  1.811981201171875e-05
msgdata_bkt generation:  0.0002880096435546875
msgdata_bkt for loop:  9.5367431640625e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0004985332489013672
len node_bkt:  576
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00022077560424804688
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.6702880859375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.956390380859375e-05
eid_bkt generation:  0.00027441978454589844
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.0002930164337158203
msgdata_bkt for loop:  9.679794311523438e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.0005528926849365234
----NodeBatch generation time:  0.008201360702514648
----Frame generation time:  1.0251998901367188e-05
---- merge nodes time:  0.00015664100646972656
invoke_udf_reduce time:  0.09449481964111328
preparing time:  0.020355701446533203
model forward time:  0.09544539451599121
loss calculation time:  7.224082946777344e-05
partial loss calculation time:  0.0010116100311279297
loss backward time:  0.016927719116210938

current graph nodes  848325
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0003299713134765625
nodes = graph.dstnodes() time :  8.487701416015625e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  9.775161743164062e-06
msgdata = Frame(msgdata) time :  7.152557373046875e-07
get ready time :  0.00047516822814941406
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.09236741065979004
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010466575622558594
tmp = F.gather_row(idx, eqidx)  2.574920654296875e-05
N = math.ceil(len(tmp)/num_split)  1.049041748046875e-05
unique_val = np.asarray(list([degree.item()]))  3.0994415283203125e-05
step:  0
bucketing time:  0.0930628776550293
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008196830749511719
assert len(eid_bkt) == deg * len(node_bkt):  1.8835067749023438e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0013034343719482422
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0003120899200439453
ndata_bkt = dstdata.subframe(node_bkt):  5.078315734863281e-05
eid_bkt generation:  0.0024728775024414062
msgdata_bkt = msgdata.subframe(eid_bkt):  4.3392181396484375e-05
msgdata_bkt generation:  0.0025162696838378906
msgdata_bkt for loop:  0.00063323974609375
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008397102355957031
----NodeBatch generation time:  0.004111051559448242
----Frame generation time:  1.3113021850585938e-05
---- merge nodes time:  0.0001659393310546875
invoke_udf_reduce time:  0.09815263748168945

current graph nodes  848325
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0001518726348876953
nodes = graph.dstnodes() time :  2.9325485229492188e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.0994415283203125e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00020623207092285156
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08521080017089844
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010609626770019531
tmp = F.gather_row(idx, eqidx)  2.5510787963867188e-05
N = math.ceil(len(tmp)/num_split)  1.2159347534179688e-05
unique_val = np.asarray(list([degree.item()]))  3.314018249511719e-05
step:  1
bucketing time:  0.0859067440032959
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008254051208496094
assert len(eid_bkt) == deg * len(node_bkt):  1.6927719116210938e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011265277862548828
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0003039836883544922
ndata_bkt = dstdata.subframe(node_bkt):  5.2928924560546875e-05
eid_bkt generation:  0.0023658275604248047
msgdata_bkt = msgdata.subframe(eid_bkt):  4.291534423828125e-05
msgdata_bkt generation:  0.002408742904663086
msgdata_bkt for loop:  0.0006198883056640625
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0008397102355957031
----NodeBatch generation time:  0.0039942264556884766
----Frame generation time:  1.3828277587890625e-05
---- merge nodes time:  0.0001647472381591797
invoke_udf_reduce time:  0.0904686450958252

current graph nodes  848325
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00015401840209960938
nodes = graph.dstnodes() time :  2.8133392333984375e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.337860107421875e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.0002079010009765625
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08543181419372559
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010204315185546875
tmp = F.gather_row(idx, eqidx)  2.6702880859375e-05
N = math.ceil(len(tmp)/num_split)  1.1920928955078125e-05
unique_val = np.asarray(list([degree.item()]))  3.123283386230469e-05
step:  2
bucketing time:  0.08614158630371094
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008313655853271484
assert len(eid_bkt) == deg * len(node_bkt):  1.6450881958007812e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.001275777816772461
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002200603485107422
ndata_bkt = dstdata.subframe(node_bkt):  5.269050598144531e-05
eid_bkt generation:  0.002364635467529297
msgdata_bkt = msgdata.subframe(eid_bkt):  4.3392181396484375e-05
msgdata_bkt generation:  0.0024080276489257812
msgdata_bkt for loop:  0.0006163120269775391
NodeBatch generation:  5.0067901611328125e-06
func(nbatch):  0.0008571147918701172
----NodeBatch generation time:  0.0040073394775390625
----Frame generation time:  1.1444091796875e-05
---- merge nodes time:  0.00016570091247558594
invoke_udf_reduce time:  0.09072041511535645

current graph nodes  848325
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0001590251922607422
nodes = graph.dstnodes() time :  2.86102294921875e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.5762786865234375e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00021457672119140625
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08589482307434082
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010442733764648438
tmp = F.gather_row(idx, eqidx)  2.5510787963867188e-05
N = math.ceil(len(tmp)/num_split)  1.1205673217773438e-05
unique_val = np.asarray(list([degree.item()]))  3.218650817871094e-05
step:  3
bucketing time:  0.0866091251373291
len node_bkt:  48150
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007419586181640625
assert len(eid_bkt) == deg * len(node_bkt):  1.6450881958007812e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0012440681457519531
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002758502960205078
ndata_bkt = dstdata.subframe(node_bkt):  5.340576171875e-05
eid_bkt generation:  0.002299070358276367
msgdata_bkt = msgdata.subframe(eid_bkt):  3.8623809814453125e-05
msgdata_bkt generation:  0.0023376941680908203
msgdata_bkt for loop:  0.0006155967712402344
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0008387565612792969
----NodeBatch generation time:  0.003915548324584961
----Frame generation time:  1.1920928955078125e-05
---- merge nodes time:  0.00016951560974121094
invoke_udf_reduce time:  0.09110832214355469
split  buckets total input  1442597
preparing time:  0.08233165740966797
model forward time :  0.37508225440979004
model forward time + loss calculation time:  0.3755350112915039
loss backward time:  0.021547794342041016
-------------------------------------------------------------------------------loss_sum  :  tensor(4.4706)

pure train time 0.5095281600952148
EPOCH:  6
full batch graph loading time:  0.04316425323486328
group buckets input  18164

current graph nodes  847553
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)

degs = graph.in_degrees() time :  0.00016570091247558594
nodes = graph.dstnodes() time :  2.9325485229492188e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  5.0067901611328125e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.0002224445343017578
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.07982707023620605
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006947517395019531
bucketing time:  0.08104085922241211
len node_bkt:  173
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0003597736358642578
assert len(eid_bkt) == deg * len(node_bkt):  1.049041748046875e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  3.075599670410156e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.9073486328125e-05
ndata_bkt = dstdata.subframe(node_bkt):  5.2928924560546875e-05
eid_bkt generation:  0.00043964385986328125
msgdata_bkt = msgdata.subframe(eid_bkt):  2.9325485229492188e-05
msgdata_bkt generation:  0.00046896934509277344
msgdata_bkt for loop:  0.00014710426330566406
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.000362396240234375
len node_bkt:  221
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002818107604980469
assert len(eid_bkt) == deg * len(node_bkt):  6.9141387939453125e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.7894973754882812e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.4781951904296875e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.9577484130859375e-05
eid_bkt generation:  0.0003428459167480469
msgdata_bkt = msgdata.subframe(eid_bkt):  2.0265579223632812e-05
msgdata_bkt generation:  0.0003631114959716797
msgdata_bkt for loop:  0.000118255615234375
NodeBatch generation:  5.4836273193359375e-06
func(nbatch):  0.000301361083984375
len node_bkt:  374
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002224445343017578
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.2411346435546875e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.1444091796875e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.956390380859375e-05
eid_bkt generation:  0.0002741813659667969
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9311904907226562e-05
msgdata_bkt generation:  0.00029349327087402344
msgdata_bkt for loop:  9.322166442871094e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.0002989768981933594
len node_bkt:  456
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021409988403320312
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.09808349609375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  9.775161743164062e-06
ndata_bkt = dstdata.subframe(node_bkt):  2.8848648071289062e-05
eid_bkt generation:  0.0002617835998535156
msgdata_bkt = msgdata.subframe(eid_bkt):  1.7881393432617188e-05
msgdata_bkt generation:  0.0002796649932861328
msgdata_bkt for loop:  9.179115295410156e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.0003509521484375
len node_bkt:  445
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021600723266601562
assert len(eid_bkt) == deg * len(node_bkt):  5.9604644775390625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.2411346435546875e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.956390380859375e-05
eid_bkt generation:  0.0002651214599609375
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.00028395652770996094
msgdata_bkt for loop:  9.202957153320312e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.00038623809814453125
len node_bkt:  550
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00022459030151367188
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.47955322265625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.049041748046875e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.0002779960632324219
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9073486328125e-05
msgdata_bkt generation:  0.0002970695495605469
msgdata_bkt for loop:  9.441375732421875e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0004642009735107422
len node_bkt:  655
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021982192993164062
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.7894973754882812e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0728836059570312e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.6716461181640625e-05
eid_bkt generation:  0.00027632713317871094
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9550323486328125e-05
msgdata_bkt generation:  0.00029587745666503906
msgdata_bkt for loop:  9.584426879882812e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.000469207763671875
len node_bkt:  512
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021839141845703125
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.47955322265625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.0002701282501220703
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.0002887248992919922
msgdata_bkt for loop:  9.441375732421875e-05
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.0005025863647460938
len node_bkt:  576
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021958351135253906
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.8371810913085938e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0279159545898438e-05
eid_bkt generation:  0.00027561187744140625
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.0002942085266113281
msgdata_bkt for loop:  9.679794311523438e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0005540847778320312
----NodeBatch generation time:  0.008297443389892578
----Frame generation time:  1.0013580322265625e-05
---- merge nodes time:  0.00016736984252929688
invoke_udf_reduce time:  0.0953664779663086
preparing time:  0.020239830017089844
model forward time:  0.09634137153625488
loss calculation time:  6.29425048828125e-05
partial loss calculation time:  0.0009827613830566406
loss backward time:  0.016828536987304688

current graph nodes  847553
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0003254413604736328
nodes = graph.dstnodes() time :  8.416175842285156e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  9.059906005859375e-06
msgdata = Frame(msgdata) time :  9.5367431640625e-07
get ready time :  0.00047016143798828125
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.092620849609375
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010275840759277344
tmp = F.gather_row(idx, eqidx)  2.6702880859375e-05
N = math.ceil(len(tmp)/num_split)  1.1682510375976562e-05
unique_val = np.asarray(list([degree.item()]))  3.123283386230469e-05
step:  0
bucketing time:  0.09332036972045898
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008306503295898438
assert len(eid_bkt) == deg * len(node_bkt):  1.71661376953125e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011205673217773438
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002906322479248047
ndata_bkt = dstdata.subframe(node_bkt):  5.1975250244140625e-05
eid_bkt generation:  0.0022766590118408203
msgdata_bkt = msgdata.subframe(eid_bkt):  4.172325134277344e-05
msgdata_bkt generation:  0.0023183822631835938
msgdata_bkt for loop:  0.0006194114685058594
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008370876312255859
----NodeBatch generation time:  0.003900289535522461
----Frame generation time:  1.0967254638671875e-05
---- merge nodes time:  0.00016164779663085938
invoke_udf_reduce time:  0.09818625450134277

current graph nodes  847553
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0001666545867919922
nodes = graph.dstnodes() time :  3.0040740966796875e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.5762786865234375e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00022268295288085938
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08539533615112305
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011944770812988281
tmp = F.gather_row(idx, eqidx)  2.8133392333984375e-05
N = math.ceil(len(tmp)/num_split)  1.1920928955078125e-05
unique_val = np.asarray(list([degree.item()]))  3.170967102050781e-05
step:  1
bucketing time:  0.08611869812011719
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008313655853271484
assert len(eid_bkt) == deg * len(node_bkt):  1.6689300537109375e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.001127004623413086
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.000331878662109375
ndata_bkt = dstdata.subframe(node_bkt):  4.982948303222656e-05
eid_bkt generation:  0.0023245811462402344
msgdata_bkt = msgdata.subframe(eid_bkt):  4.3392181396484375e-05
msgdata_bkt generation:  0.0023679733276367188
msgdata_bkt for loop:  0.0006232261657714844
NodeBatch generation:  4.76837158203125e-06
func(nbatch):  0.0008633136749267578
----NodeBatch generation time:  0.003983497619628906
----Frame generation time:  1.1920928955078125e-05
---- merge nodes time:  0.00016927719116210938
invoke_udf_reduce time:  0.09069514274597168

current graph nodes  847553
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00016045570373535156
nodes = graph.dstnodes() time :  2.8371810913085938e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.337860107421875e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00021529197692871094
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08590364456176758
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00014448165893554688
tmp = F.gather_row(idx, eqidx)  2.6702880859375e-05
N = math.ceil(len(tmp)/num_split)  1.1682510375976562e-05
unique_val = np.asarray(list([degree.item()]))  3.337860107421875e-05
step:  2
bucketing time:  0.08664679527282715
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008234977722167969
assert len(eid_bkt) == deg * len(node_bkt):  1.6927719116210938e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.001165628433227539
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0003371238708496094
ndata_bkt = dstdata.subframe(node_bkt):  7.152557373046875e-05
eid_bkt generation:  0.0023615360260009766
msgdata_bkt = msgdata.subframe(eid_bkt):  4.076957702636719e-05
msgdata_bkt generation:  0.0024023056030273438
msgdata_bkt for loop:  0.0006322860717773438
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0008361339569091797
----NodeBatch generation time:  0.004083156585693359
----Frame generation time:  1.2874603271484375e-05
---- merge nodes time:  0.00017833709716796875
invoke_udf_reduce time:  0.09132695198059082

current graph nodes  847553
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00015592575073242188
nodes = graph.dstnodes() time :  2.9325485229492188e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.0994415283203125e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00021147727966308594
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08916401863098145
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011110305786132812
tmp = F.gather_row(idx, eqidx)  2.5987625122070312e-05
N = math.ceil(len(tmp)/num_split)  1.1682510375976562e-05
unique_val = np.asarray(list([degree.item()]))  3.0994415283203125e-05
step:  3
bucketing time:  0.08986949920654297
len node_bkt:  48150
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007829666137695312
assert len(eid_bkt) == deg * len(node_bkt):  1.52587890625e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0017306804656982422
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00023794174194335938
ndata_bkt = dstdata.subframe(node_bkt):  5.125999450683594e-05
eid_bkt generation:  0.0027878284454345703
msgdata_bkt = msgdata.subframe(eid_bkt):  4.2438507080078125e-05
msgdata_bkt generation:  0.0028302669525146484
msgdata_bkt for loop:  0.0006196498870849609
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.0008411407470703125
----NodeBatch generation time:  0.004415988922119141
----Frame generation time:  1.239776611328125e-05
---- merge nodes time:  0.0001723766326904297
invoke_udf_reduce time:  0.09486556053161621
split  buckets total input  1441226
preparing time:  0.0824117660522461
model forward time :  0.37974095344543457
model forward time + loss calculation time:  0.3801994323730469
loss backward time:  0.022142887115478516
-------------------------------------------------------------------------------loss_sum  :  tensor(4.4048)

pure train time 0.5155751705169678
EPOCH:  7
full batch graph loading time:  0.05042672157287598
group buckets input  18164

current graph nodes  848583
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)

degs = graph.in_degrees() time :  0.00016951560974121094
nodes = graph.dstnodes() time :  3.0040740966796875e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  5.0067901611328125e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.0002295970916748047
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08280062675476074
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006892681121826172
bucketing time:  0.08400273323059082
len node_bkt:  173
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00035309791564941406
assert len(eid_bkt) == deg * len(node_bkt):  1.1205673217773438e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  3.0279159545898438e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  2.0742416381835938e-05
ndata_bkt = dstdata.subframe(node_bkt):  5.1021575927734375e-05
eid_bkt generation:  0.0004374980926513672
msgdata_bkt = msgdata.subframe(eid_bkt):  2.8133392333984375e-05
msgdata_bkt generation:  0.00046563148498535156
msgdata_bkt for loop:  0.00013113021850585938
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.0003790855407714844
len node_bkt:  221
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00026607513427734375
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.765655517578125e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.430511474609375e-05
ndata_bkt = dstdata.subframe(node_bkt):  4.029273986816406e-05
eid_bkt generation:  0.0003268718719482422
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9788742065429688e-05
msgdata_bkt generation:  0.0003466606140136719
msgdata_bkt for loop:  0.0001068115234375
NodeBatch generation:  1.5497207641601562e-05
func(nbatch):  0.0003066062927246094
len node_bkt:  374
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021886825561523438
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  1.9788742065429688e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.8848648071289062e-05
eid_bkt generation:  0.00026702880859375
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.0002856254577636719
msgdata_bkt for loop:  9.036064147949219e-05
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.00030493736267089844
len node_bkt:  456
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021266937255859375
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.1696090698242188e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9325485229492188e-05
eid_bkt generation:  0.00026297569274902344
msgdata_bkt = msgdata.subframe(eid_bkt):  1.7404556274414062e-05
msgdata_bkt generation:  0.0002803802490234375
msgdata_bkt for loop:  9.202957153320312e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0003464221954345703
len node_bkt:  445
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021314620971679688
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.193450927734375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.956390380859375e-05
eid_bkt generation:  0.000263214111328125
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.0002818107604980469
msgdata_bkt for loop:  9.202957153320312e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0003924369812011719
len node_bkt:  550
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021576881408691406
assert len(eid_bkt) == deg * len(node_bkt):  6.67572021484375e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  3.0994415283203125e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.049041748046875e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9087066650390625e-05
eid_bkt generation:  0.000274658203125
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.00029349327087402344
msgdata_bkt for loop:  9.465217590332031e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0004475116729736328
len node_bkt:  655
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021958351135253906
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.8371810913085938e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.239776611328125e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0517578125e-05
eid_bkt generation:  0.0002777576446533203
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.0002963542938232422
msgdata_bkt for loop:  9.608268737792969e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.0004775524139404297
len node_bkt:  512
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021648406982421875
assert len(eid_bkt) == deg * len(node_bkt):  5.9604644775390625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.5272369384765625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.049041748046875e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9087066650390625e-05
eid_bkt generation:  0.0002701282501220703
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8358230590820312e-05
msgdata_bkt generation:  0.0002884864807128906
msgdata_bkt for loop:  9.608268737792969e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0005161762237548828
len node_bkt:  576
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00022721290588378906
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.8848648071289062e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.00028395652770996094
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.0003027915954589844
msgdata_bkt for loop:  9.775161743164062e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0005991458892822266
----NodeBatch generation time:  0.008310079574584961
----Frame generation time:  1.049041748046875e-05
---- merge nodes time:  0.0001678466796875
invoke_udf_reduce time:  0.09838461875915527
preparing time:  0.020331621170043945
model forward time:  0.09933686256408691
loss calculation time:  6.127357482910156e-05
partial loss calculation time:  0.0010080337524414062
loss backward time:  0.018561601638793945

current graph nodes  848583
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0003266334533691406
nodes = graph.dstnodes() time :  8.463859558105469e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  9.059906005859375e-06
msgdata = Frame(msgdata) time :  7.152557373046875e-07
get ready time :  0.00047206878662109375
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.09144139289855957
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011920928955078125
tmp = F.gather_row(idx, eqidx)  2.574920654296875e-05
N = math.ceil(len(tmp)/num_split)  1.0967254638671875e-05
unique_val = np.asarray(list([degree.item()]))  3.2901763916015625e-05
step:  0
bucketing time:  0.09215903282165527
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007982254028320312
assert len(eid_bkt) == deg * len(node_bkt):  1.52587890625e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.001131296157836914
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00024700164794921875
ndata_bkt = dstdata.subframe(node_bkt):  5.269050598144531e-05
eid_bkt generation:  0.0022096633911132812
msgdata_bkt = msgdata.subframe(eid_bkt):  4.172325134277344e-05
msgdata_bkt generation:  0.0022513866424560547
msgdata_bkt for loop:  0.0006268024444580078
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0008451938629150391
----NodeBatch generation time:  0.003847837448120117
----Frame generation time:  1.0967254638671875e-05
---- merge nodes time:  0.00016307830810546875
invoke_udf_reduce time:  0.09697127342224121

current graph nodes  848583
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.000156402587890625
nodes = graph.dstnodes() time :  2.7894973754882812e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.337860107421875e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.0002117156982421875
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08811545372009277
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.000102996826171875
tmp = F.gather_row(idx, eqidx)  2.7179718017578125e-05
N = math.ceil(len(tmp)/num_split)  1.1920928955078125e-05
unique_val = np.asarray(list([degree.item()]))  3.123283386230469e-05
step:  1
bucketing time:  0.08881354331970215
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008249282836914062
assert len(eid_bkt) == deg * len(node_bkt):  1.5974044799804688e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.00113677978515625
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0003170967102050781
ndata_bkt = dstdata.subframe(node_bkt):  5.245208740234375e-05
eid_bkt generation:  0.0023140907287597656
msgdata_bkt = msgdata.subframe(eid_bkt):  4.100799560546875e-05
msgdata_bkt generation:  0.0023550987243652344
msgdata_bkt for loop:  0.0006191730499267578
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008134841918945312
----NodeBatch generation time:  0.003915548324584961
----Frame generation time:  1.1205673217773438e-05
---- merge nodes time:  0.0001647472381591797
invoke_udf_reduce time:  0.09330248832702637

current graph nodes  848583
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00015282630920410156
nodes = graph.dstnodes() time :  2.86102294921875e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.5762786865234375e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00020813941955566406
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.0896751880645752
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010418891906738281
tmp = F.gather_row(idx, eqidx)  2.5033950805664062e-05
N = math.ceil(len(tmp)/num_split)  1.1444091796875e-05
unique_val = np.asarray(list([degree.item()]))  3.0994415283203125e-05
step:  2
bucketing time:  0.09036517143249512
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008378028869628906
assert len(eid_bkt) == deg * len(node_bkt):  1.8596649169921875e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011398792266845703
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00031447410583496094
ndata_bkt = dstdata.subframe(node_bkt):  5.078315734863281e-05
eid_bkt generation:  0.002332925796508789
msgdata_bkt = msgdata.subframe(eid_bkt):  4.076957702636719e-05
msgdata_bkt generation:  0.0023736953735351562
msgdata_bkt for loop:  0.0006167888641357422
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008208751678466797
----NodeBatch generation time:  0.003934144973754883
----Frame generation time:  1.1682510375976562e-05
---- merge nodes time:  0.00016808509826660156
invoke_udf_reduce time:  0.09487175941467285

current graph nodes  848583
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.000156402587890625
nodes = graph.dstnodes() time :  2.8371810913085938e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.814697265625e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00021147727966308594
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.0874626636505127
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010442733764648438
tmp = F.gather_row(idx, eqidx)  2.5272369384765625e-05
N = math.ceil(len(tmp)/num_split)  1.1682510375976562e-05
unique_val = np.asarray(list([degree.item()]))  3.075599670410156e-05
step:  3
bucketing time:  0.08815240859985352
len node_bkt:  48150
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007381439208984375
assert len(eid_bkt) == deg * len(node_bkt):  1.71661376953125e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0012972354888916016
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00024175643920898438
ndata_bkt = dstdata.subframe(node_bkt):  5.412101745605469e-05
eid_bkt generation:  0.0023152828216552734
msgdata_bkt = msgdata.subframe(eid_bkt):  4.220008850097656e-05
msgdata_bkt generation:  0.00235748291015625
msgdata_bkt for loop:  0.0006167888641357422
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008220672607421875
----NodeBatch generation time:  0.003922462463378906
----Frame generation time:  1.3113021850585938e-05
---- merge nodes time:  0.00016617774963378906
invoke_udf_reduce time:  0.0926506519317627
split  buckets total input  1441628
preparing time:  0.08248281478881836
model forward time :  0.3823561668395996
model forward time + loss calculation time:  0.382753849029541
loss backward time:  0.017543792724609375
-------------------------------------------------------------------------------loss_sum  :  tensor(4.3381)

pure train time 0.5182573795318604
EPOCH:  8
full batch graph loading time:  0.057526350021362305
group buckets input  18164

current graph nodes  848110
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)

degs = graph.in_degrees() time :  0.00015783309936523438
nodes = graph.dstnodes() time :  2.9087066650390625e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  4.5299530029296875e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00021886825561523438
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08008098602294922
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006821155548095703
bucketing time:  0.08128070831298828
len node_bkt:  173
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0003552436828613281
assert len(eid_bkt) == deg * len(node_bkt):  1.0967254638671875e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.9087066650390625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  2.002716064453125e-05
ndata_bkt = dstdata.subframe(node_bkt):  5.173683166503906e-05
eid_bkt generation:  0.0004336833953857422
msgdata_bkt = msgdata.subframe(eid_bkt):  2.7418136596679688e-05
msgdata_bkt generation:  0.0004611015319824219
msgdata_bkt for loop:  0.0001277923583984375
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0003631114959716797
len node_bkt:  221
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002675056457519531
assert len(eid_bkt) == deg * len(node_bkt):  7.152557373046875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.6941299438476562e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.2874603271484375e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.838539123535156e-05
eid_bkt generation:  0.00032711029052734375
msgdata_bkt = msgdata.subframe(eid_bkt):  2.2411346435546875e-05
msgdata_bkt generation:  0.0003495216369628906
msgdata_bkt for loop:  0.00010538101196289062
NodeBatch generation:  1.621246337890625e-05
func(nbatch):  0.0002923011779785156
len node_bkt:  374
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002224445343017578
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  1.8835067749023438e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  9.775161743164062e-06
ndata_bkt = dstdata.subframe(node_bkt):  2.9325485229492188e-05
eid_bkt generation:  0.0002694129943847656
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.00028824806213378906
msgdata_bkt for loop:  9.059906005859375e-05
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.00029587745666503906
len node_bkt:  456
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021910667419433594
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.1457672119140625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  9.775161743164062e-06
ndata_bkt = dstdata.subframe(node_bkt):  2.9325485229492188e-05
eid_bkt generation:  0.0002684593200683594
msgdata_bkt = msgdata.subframe(eid_bkt):  1.7881393432617188e-05
msgdata_bkt generation:  0.00028634071350097656
msgdata_bkt for loop:  9.179115295410156e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0003409385681152344
len node_bkt:  445
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021505355834960938
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.193450927734375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  9.775161743164062e-06
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.00026345252990722656
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8358230590820312e-05
msgdata_bkt generation:  0.0002818107604980469
msgdata_bkt for loop:  9.989738464355469e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.00037980079650878906
len node_bkt:  550
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021529197692871094
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.47955322265625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.956390380859375e-05
eid_bkt generation:  0.00026798248291015625
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8358230590820312e-05
msgdata_bkt generation:  0.00028634071350097656
msgdata_bkt for loop:  9.298324584960938e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0004286766052246094
len node_bkt:  655
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021529197692871094
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.7418136596679688e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.00026988983154296875
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.0002884864807128906
msgdata_bkt for loop:  9.489059448242188e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.00046896934509277344
len node_bkt:  512
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021910667419433594
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.5987625122070312e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0728836059570312e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.956390380859375e-05
eid_bkt generation:  0.0002727508544921875
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.0002913475036621094
msgdata_bkt for loop:  9.703636169433594e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0005044937133789062
len node_bkt:  576
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021958351135253906
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.956390380859375e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0728836059570312e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.0002765655517578125
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9073486328125e-05
msgdata_bkt generation:  0.0002956390380859375
msgdata_bkt for loop:  9.679794311523438e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0005593299865722656
----NodeBatch generation time:  0.00811147689819336
----Frame generation time:  1.0251998901367188e-05
---- merge nodes time:  0.00015497207641601562
invoke_udf_reduce time:  0.0954430103302002
preparing time:  0.020450115203857422
model forward time:  0.09641909599304199
loss calculation time:  7.224082946777344e-05
partial loss calculation time:  0.0009984970092773438
loss backward time:  0.015652894973754883

current graph nodes  848110
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00014209747314453125
nodes = graph.dstnodes() time :  3.361701965332031e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  4.0531158447265625e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00020074844360351562
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08757162094116211
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010800361633300781
tmp = F.gather_row(idx, eqidx)  2.86102294921875e-05
N = math.ceil(len(tmp)/num_split)  1.1444091796875e-05
unique_val = np.asarray(list([degree.item()]))  3.266334533691406e-05
step:  0
bucketing time:  0.08834505081176758
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008392333984375
assert len(eid_bkt) == deg * len(node_bkt):  1.5020370483398438e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0012373924255371094
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002760887145996094
ndata_bkt = dstdata.subframe(node_bkt):  5.340576171875e-05
eid_bkt generation:  0.0023860931396484375
msgdata_bkt = msgdata.subframe(eid_bkt):  3.981590270996094e-05
msgdata_bkt generation:  0.0024259090423583984
msgdata_bkt for loop:  0.000629425048828125
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0008504390716552734
----NodeBatch generation time:  0.004040956497192383
----Frame generation time:  1.2159347534179688e-05
---- merge nodes time:  0.00016069412231445312
invoke_udf_reduce time:  0.09292960166931152

current graph nodes  848110
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00020122528076171875
nodes = graph.dstnodes() time :  3.075599670410156e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.814697265625e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00025844573974609375
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08599042892456055
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011658668518066406
tmp = F.gather_row(idx, eqidx)  2.9802322387695312e-05
N = math.ceil(len(tmp)/num_split)  1.2874603271484375e-05
unique_val = np.asarray(list([degree.item()]))  4.3392181396484375e-05
step:  1
bucketing time:  0.08676767349243164
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.000850677490234375
assert len(eid_bkt) == deg * len(node_bkt):  1.6927719116210938e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011780261993408203
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00032830238342285156
ndata_bkt = dstdata.subframe(node_bkt):  5.2928924560546875e-05
eid_bkt generation:  0.0023925304412841797
msgdata_bkt = msgdata.subframe(eid_bkt):  4.029273986816406e-05
msgdata_bkt generation:  0.0024328231811523438
msgdata_bkt for loop:  0.0006449222564697266
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0009026527404785156
----NodeBatch generation time:  0.0041124820709228516
----Frame generation time:  1.1205673217773438e-05
---- merge nodes time:  0.00017905235290527344
invoke_udf_reduce time:  0.09165763854980469

current graph nodes  848110
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00017309188842773438
nodes = graph.dstnodes() time :  2.9087066650390625e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.337860107421875e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.0002288818359375
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08728313446044922
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010991096496582031
tmp = F.gather_row(idx, eqidx)  3.314018249511719e-05
N = math.ceil(len(tmp)/num_split)  1.1682510375976562e-05
unique_val = np.asarray(list([degree.item()]))  3.528594970703125e-05
step:  2
bucketing time:  0.08801794052124023
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008225440979003906
assert len(eid_bkt) == deg * len(node_bkt):  1.621246337890625e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011532306671142578
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00032520294189453125
ndata_bkt = dstdata.subframe(node_bkt):  5.245208740234375e-05
eid_bkt generation:  0.002335786819458008
msgdata_bkt = msgdata.subframe(eid_bkt):  4.315376281738281e-05
msgdata_bkt generation:  0.0023789405822753906
msgdata_bkt for loop:  0.0006470680236816406
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008671283721923828
----NodeBatch generation time:  0.004019260406494141
----Frame generation time:  1.1920928955078125e-05
---- merge nodes time:  0.00017189979553222656
invoke_udf_reduce time:  0.09266352653503418

current graph nodes  848110
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0001704692840576172
nodes = graph.dstnodes() time :  3.075599670410156e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.337860107421875e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.0002269744873046875
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08701682090759277
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00012040138244628906
tmp = F.gather_row(idx, eqidx)  2.9802322387695312e-05
N = math.ceil(len(tmp)/num_split)  1.1682510375976562e-05
unique_val = np.asarray(list([degree.item()]))  3.6716461181640625e-05
step:  3
bucketing time:  0.08777880668640137
len node_bkt:  48150
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007627010345458984
assert len(eid_bkt) == deg * len(node_bkt):  1.6927719116210938e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.00118255615234375
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00022840499877929688
ndata_bkt = dstdata.subframe(node_bkt):  5.435943603515625e-05
eid_bkt generation:  0.0022063255310058594
msgdata_bkt = msgdata.subframe(eid_bkt):  4.00543212890625e-05
msgdata_bkt generation:  0.002246379852294922
msgdata_bkt for loop:  0.0006365776062011719
NodeBatch generation:  6.67572021484375e-06
func(nbatch):  0.0008985996246337891
----NodeBatch generation time:  0.003911733627319336
----Frame generation time:  1.3828277587890625e-05
---- merge nodes time:  0.00020241737365722656
invoke_udf_reduce time:  0.09235668182373047
split  buckets total input  1441113
preparing time:  0.08106327056884766
model forward time :  0.37458014488220215
model forward time + loss calculation time:  0.37503623962402344
loss backward time:  0.020256996154785156
-------------------------------------------------------------------------------loss_sum  :  tensor(4.2706)

pure train time 0.5074374675750732
EPOCH:  9
full batch graph loading time:  0.043941497802734375
group buckets input  18164

current graph nodes  848411
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)

degs = graph.in_degrees() time :  0.0001773834228515625
nodes = graph.dstnodes() time :  3.0040740966796875e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  4.5299530029296875e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00023627281188964844
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08157873153686523
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006926059722900391
bucketing time:  0.08278369903564453
len node_bkt:  173
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0003573894500732422
assert len(eid_bkt) == deg * len(node_bkt):  1.239776611328125e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  3.814697265625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  2.002716064453125e-05
ndata_bkt = dstdata.subframe(node_bkt):  5.364418029785156e-05
eid_bkt generation:  0.0004467964172363281
msgdata_bkt = msgdata.subframe(eid_bkt):  2.956390380859375e-05
msgdata_bkt generation:  0.0004763603210449219
msgdata_bkt for loop:  0.00013136863708496094
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0003650188446044922
len node_bkt:  221
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00026488304138183594
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.5987625122070312e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.4066696166992188e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.933906555175781e-05
eid_bkt generation:  0.00032329559326171875
msgdata_bkt = msgdata.subframe(eid_bkt):  2.002716064453125e-05
msgdata_bkt generation:  0.00034332275390625
msgdata_bkt for loop:  0.00010561943054199219
NodeBatch generation:  5.9604644775390625e-06
func(nbatch):  0.0002980232238769531
len node_bkt:  374
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00022840499877929688
assert len(eid_bkt) == deg * len(node_bkt):  6.67572021484375e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.0265579223632812e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.049041748046875e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.956390380859375e-05
eid_bkt generation:  0.0002818107604980469
msgdata_bkt = msgdata.subframe(eid_bkt):  2.002716064453125e-05
msgdata_bkt generation:  0.0003018379211425781
msgdata_bkt for loop:  9.34600830078125e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0003261566162109375
len node_bkt:  456
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00022459030151367188
assert len(eid_bkt) == deg * len(node_bkt):  6.67572021484375e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.1219253540039062e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9325485229492188e-05
eid_bkt generation:  0.00027441978454589844
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8596649169921875e-05
msgdata_bkt generation:  0.0002930164337158203
msgdata_bkt for loop:  9.274482727050781e-05
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.000339508056640625
len node_bkt:  445
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.000213623046875
assert len(eid_bkt) == deg * len(node_bkt):  6.67572021484375e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.2411346435546875e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0013580322265625e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0040740966796875e-05
eid_bkt generation:  0.0002636909484863281
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.00028252601623535156
msgdata_bkt for loop:  9.179115295410156e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0003814697265625
len node_bkt:  550
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002143383026123047
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.5033950805664062e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0279159545898438e-05
eid_bkt generation:  0.0002677440643310547
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9073486328125e-05
msgdata_bkt generation:  0.0002868175506591797
msgdata_bkt for loop:  9.393692016601562e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.00042748451232910156
len node_bkt:  655
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0002162456512451172
assert len(eid_bkt) == deg * len(node_bkt):  6.198883056640625e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.7179718017578125e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.9802322387695312e-05
eid_bkt generation:  0.00027060508728027344
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8358230590820312e-05
msgdata_bkt generation:  0.00028896331787109375
msgdata_bkt for loop:  9.5367431640625e-05
NodeBatch generation:  3.5762786865234375e-06
func(nbatch):  0.0004677772521972656
len node_bkt:  512
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00021648406982421875
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.47955322265625e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0251998901367188e-05
ndata_bkt = dstdata.subframe(node_bkt):  3.0517578125e-05
eid_bkt generation:  0.0002689361572265625
msgdata_bkt = msgdata.subframe(eid_bkt):  1.8835067749023438e-05
msgdata_bkt generation:  0.00028777122497558594
msgdata_bkt for loop:  9.512901306152344e-05
NodeBatch generation:  3.814697265625e-06
func(nbatch):  0.0005128383636474609
len node_bkt:  576
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.00022125244140625
assert len(eid_bkt) == deg * len(node_bkt):  6.4373016357421875e-06
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  2.9325485229492188e-05
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  1.0728836059570312e-05
ndata_bkt = dstdata.subframe(node_bkt):  2.956390380859375e-05
eid_bkt generation:  0.00027823448181152344
msgdata_bkt = msgdata.subframe(eid_bkt):  1.9073486328125e-05
msgdata_bkt generation:  0.00029730796813964844
msgdata_bkt for loop:  9.72747802734375e-05
NodeBatch generation:  4.0531158447265625e-06
func(nbatch):  0.0005471706390380859
----NodeBatch generation time:  0.008236169815063477
----Frame generation time:  1.0013580322265625e-05
---- merge nodes time:  0.0001571178436279297
invoke_udf_reduce time:  0.09713459014892578
preparing time:  0.020555496215820312
model forward time:  0.09810948371887207
loss calculation time:  6.246566772460938e-05
partial loss calculation time:  0.0010063648223876953
loss backward time:  0.013772010803222656

current graph nodes  848411
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00014138221740722656
nodes = graph.dstnodes() time :  3.457069396972656e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.5762786865234375e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00020122528076171875
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08720159530639648
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010728836059570312
tmp = F.gather_row(idx, eqidx)  2.8133392333984375e-05
N = math.ceil(len(tmp)/num_split)  1.2874603271484375e-05
unique_val = np.asarray(list([degree.item()]))  3.24249267578125e-05
step:  0
bucketing time:  0.08790969848632812
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007562637329101562
assert len(eid_bkt) == deg * len(node_bkt):  1.6450881958007812e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011250972747802734
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00023102760314941406
ndata_bkt = dstdata.subframe(node_bkt):  5.269050598144531e-05
eid_bkt generation:  0.0021469593048095703
msgdata_bkt = msgdata.subframe(eid_bkt):  3.981590270996094e-05
msgdata_bkt generation:  0.0021867752075195312
msgdata_bkt for loop:  0.0006182193756103516
NodeBatch generation:  4.76837158203125e-06
func(nbatch):  0.0008263587951660156
----NodeBatch generation time:  0.003756284713745117
----Frame generation time:  1.1682510375976562e-05
---- merge nodes time:  0.00016450881958007812
invoke_udf_reduce time:  0.09221506118774414

current graph nodes  848411
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.0001518726348876953
nodes = graph.dstnodes() time :  2.8848648071289062e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.0994415283203125e-06
msgdata = Frame(msgdata) time :  4.76837158203125e-07
get ready time :  0.00020623207092285156
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08675503730773926
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010919570922851562
tmp = F.gather_row(idx, eqidx)  2.86102294921875e-05
N = math.ceil(len(tmp)/num_split)  1.0967254638671875e-05
unique_val = np.asarray(list([degree.item()]))  3.218650817871094e-05
step:  1
bucketing time:  0.08746576309204102
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008232593536376953
assert len(eid_bkt) == deg * len(node_bkt):  1.6927719116210938e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011703968048095703
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.00028133392333984375
ndata_bkt = dstdata.subframe(node_bkt):  5.340576171875e-05
eid_bkt generation:  0.0023725032806396484
msgdata_bkt = msgdata.subframe(eid_bkt):  4.220008850097656e-05
msgdata_bkt generation:  0.002414703369140625
msgdata_bkt for loop:  0.0006251335144042969
NodeBatch generation:  4.76837158203125e-06
func(nbatch):  0.0008280277252197266
----NodeBatch generation time:  0.0039958953857421875
----Frame generation time:  1.1682510375976562e-05
---- merge nodes time:  0.0001633167266845703
invoke_udf_reduce time:  0.0920262336730957

current graph nodes  848411
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00015544891357421875
nodes = graph.dstnodes() time :  2.8133392333984375e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  3.0994415283203125e-06
msgdata = Frame(msgdata) time :  7.152557373046875e-07
get ready time :  0.0002090930938720703
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08683300018310547
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010919570922851562
tmp = F.gather_row(idx, eqidx)  2.9087066650390625e-05
N = math.ceil(len(tmp)/num_split)  1.1444091796875e-05
unique_val = np.asarray(list([degree.item()]))  3.24249267578125e-05
step:  2
bucketing time:  0.08754706382751465
len node_bkt:  48153
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0008485317230224609
assert len(eid_bkt) == deg * len(node_bkt):  1.5497207641601562e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.0011515617370605469
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002675056457519531
ndata_bkt = dstdata.subframe(node_bkt):  5.1021575927734375e-05
eid_bkt generation:  0.0023026466369628906
msgdata_bkt = msgdata.subframe(eid_bkt):  3.6716461181640625e-05
msgdata_bkt generation:  0.0023393630981445312
msgdata_bkt for loop:  0.0006170272827148438
NodeBatch generation:  4.291534423828125e-06
func(nbatch):  0.0008211135864257812
----NodeBatch generation time:  0.003909111022949219
----Frame generation time:  1.1920928955078125e-05
---- merge nodes time:  0.00017499923706054688
invoke_udf_reduce time:  0.09203958511352539

current graph nodes  848411
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)

degs = graph.in_degrees() time :  0.00015616416931152344
nodes = graph.dstnodes() time :  4.696846008300781e-05
ntid = graph.get_ntype_id_from_dst(ntype) time :  4.291534423828125e-06
msgdata = Frame(msgdata) time :  2.384185791015625e-07
get ready time :  0.00023102760314941406
len val:  196571
----------- core.py torch.sort() replace to OrderedDict time:  0.08722043037414551
eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00012040138244628906
tmp = F.gather_row(idx, eqidx)  2.765655517578125e-05
N = math.ceil(len(tmp)/num_split)  1.1920928955078125e-05
unique_val = np.asarray(list([degree.item()]))  3.7670135498046875e-05
step:  3
bucketing time:  0.08794617652893066
len node_bkt:  48150
eid_bkt = F.zerocopy_to_numpy(graph.in_edges(node_bkt, form=eid):  0.0007410049438476562
assert len(eid_bkt) == deg * len(node_bkt):  1.6689300537109375e-05
eid_bkt = np.sort(eid_bkt.reshape((len(node_bkt), deg)), 1):  0.001171112060546875
eid_bkt = F.zerocopy_from_numpy(eid_bkt.flatten()):  0.0002288818359375
ndata_bkt = dstdata.subframe(node_bkt):  5.1975250244140625e-05
eid_bkt generation:  0.0021789073944091797
msgdata_bkt = msgdata.subframe(eid_bkt):  4.1484832763671875e-05
msgdata_bkt generation:  0.0022203922271728516
msgdata_bkt for loop:  0.0006122589111328125
NodeBatch generation:  4.5299530029296875e-06
func(nbatch):  0.0008301734924316406
----NodeBatch generation time:  0.0037860870361328125
----Frame generation time:  1.1920928955078125e-05
---- merge nodes time:  0.00016164779663085938
invoke_udf_reduce time:  0.09233665466308594
split  buckets total input  1441544
preparing time:  0.08058762550354004
model forward time :  0.3726353645324707
model forward time + loss calculation time:  0.37305188179016113
loss backward time:  0.01693272590637207
-------------------------------------------------------------------------------loss_sum  :  tensor(4.1990)

pure train time 0.5019285678863525

avg epoch time:  2.2978993483952115
avg pure train time:  0.5090291840689523
avg block subtensor loading time:  0.1353140217917306
avg preparing time:  0.18934178352355957
avg block to device time:  0.017067023686000278
avg grouping time:  0.1339763913835798
avg splitting time:  1.7582142012459892
avg optimizing time:  0.0011813299996512277

avg input nodes number :  1459849.857142857
avg real block input nodes number :  848217.2857142857
avg input nodes number/pure train time :  2867909.940788598
avg input nodes number/avg epoch time :  635297.5634735156
