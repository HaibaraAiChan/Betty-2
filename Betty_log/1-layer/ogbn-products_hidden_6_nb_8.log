main start at this time 1671170829.2919042
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.337890625 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.337890625 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

REG start----................................
Convert a graph into a bidirected graph: 0.585 seconds, peak memory: 30.210 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.210 GB
Metis partitioning: 2.482 seconds, peak memory: 30.210 GB
Split the graph: 0.459 seconds
Construct subgraphs: 0.187 seconds
REG metis partition end ----................................
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.337890625 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

connection checking time:  1.5482525825500488
block generation total time  1.4516279697418213
average batch blocks generation time:  0.18145349621772766
pseudo mini batch 0 input nodes size: 136884
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.337890625 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.337890625 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.390625 GB
    Memory Allocated: 0.0513310432434082  GigaBytes
Max Memory Allocated: 0.0513310432434082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.390625 GB
    Memory Allocated: 0.05151844024658203  GigaBytes
Max Memory Allocated: 0.05151844024658203  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.390625 GB
    Memory Allocated: 0.05151844024658203  GigaBytes
Max Memory Allocated: 0.05151844024658203  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24889, 9: 54, 1: 39, 7: 24, 8: 21, 4: 20, 5: 18, 3: 17, 6: 16, 2: 11})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.482421875 GB
    Memory Allocated: 0.05533933639526367  GigaBytes
Max Memory Allocated: 0.05533933639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.482421875 GB
    Memory Allocated: 0.05533933639526367  GigaBytes
Max Memory Allocated: 0.05533933639526367  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.21484375 GB
    Memory Allocated: 1.4999375343322754  GigaBytes
Max Memory Allocated: 1.6781988143920898  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.21484375 GB
    Memory Allocated: 1.5048961639404297  GigaBytes
Max Memory Allocated: 1.6781988143920898  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.22265625 GB
    Memory Allocated: 0.0600743293762207  GigaBytes
Max Memory Allocated: 1.6781988143920898  GigaBytes

pseudo mini batch 1 input nodes size: 110854
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.22265625 GB
    Memory Allocated: 0.05625343322753906  GigaBytes
Max Memory Allocated: 1.6781988143920898  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.22265625 GB
    Memory Allocated: 0.05625343322753906  GigaBytes
Max Memory Allocated: 1.6781988143920898  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.22265625 GB
    Memory Allocated: 0.0975499153137207  GigaBytes
Max Memory Allocated: 1.6781988143920898  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.22265625 GB
    Memory Allocated: 0.09773778915405273  GigaBytes
Max Memory Allocated: 1.6781988143920898  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.22265625 GB
    Memory Allocated: 0.046556949615478516  GigaBytes
Max Memory Allocated: 1.6781988143920898  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24463, 8: 120, 6: 104, 7: 102, 4: 100, 9: 94, 5: 83, 3: 61, 2: 44, 1: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.22265625 GB
    Memory Allocated: 0.050360679626464844  GigaBytes
Max Memory Allocated: 1.6781988143920898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.22265625 GB
    Memory Allocated: 0.050360679626464844  GigaBytes
Max Memory Allocated: 1.6781988143920898  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 1.503305435180664  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 1.507718563079834  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.05037689208984375  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

pseudo mini batch 2 input nodes size: 118843
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.04657316207885742  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.04657316207885742  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.09084606170654297  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.09102964401245117  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.0495452880859375  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24200, 9: 69, 7: 60, 8: 58, 6: 54, 5: 46, 4: 45, 3: 36, 2: 25, 1: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.05328035354614258  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.05328035354614258  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 1.4601902961730957  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 1.4645004272460938  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.0531773567199707  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

pseudo mini batch 3 input nodes size: 123097
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.049442291259765625  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.049442291259765625  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.09529972076416016  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.09548187255859375  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.051025390625  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23877, 7: 93, 6: 88, 8: 79, 5: 78, 4: 72, 9: 68, 3: 37, 2: 31, 1: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.05472517013549805  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.05472517013549805  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 1.4488043785095215  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 1.4531145095825195  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.05469512939453125  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

pseudo mini batch 4 input nodes size: 137467
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.0509953498840332  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.0509953498840332  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.10220623016357422  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.10239362716674805  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.05635404586791992  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 25025, 9: 20, 2: 16, 3: 11, 5: 10, 6: 9, 8: 8, 4: 5, 7: 4, 1: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.060184478759765625  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.33203125 GB
    Memory Allocated: 0.060184478759765625  GigaBytes
Max Memory Allocated: 1.6837825775146484  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 1.513585090637207  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 1.5179824829101562  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.060301780700683594  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

pseudo mini batch 5 input nodes size: 122383
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05647134780883789  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05647134780883789  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.10206270217895508  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.10224246978759766  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05084419250488281  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23691, 9: 83, 7: 71, 8: 56, 6: 54, 5: 35, 4: 23, 3: 22, 1: 16, 2: 14})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05450105667114258  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05450105667114258  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 1.432373046875  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 1.4365873336791992  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05431795120239258  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

pseudo mini batch 6 input nodes size: 135227
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05066108703613281  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05066108703613281  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.10103750228881836  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.10121679306030273  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05544567108154297  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23297, 7: 142, 5: 104, 4: 104, 3: 103, 6: 99, 8: 93, 9: 62, 2: 43, 1: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05907154083251953  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05907154083251953  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 1.4251646995544434  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 1.4293789863586426  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05907106399536133  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

pseudo mini batch 7 input nodes size: 136130
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.055445194244384766  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.055445194244384766  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.10615777969360352  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.10633659362792969  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.055780887603759766  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23167, 7: 159, 6: 126, 9: 126, 3: 87, 4: 87, 8: 77, 5: 71, 2: 37, 1: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05939340591430664  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.48046875 GB
    Memory Allocated: 0.05939340591430664  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 1.420274257659912  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 1.424471378326416  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.05937671661376953  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.060051918029785156  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.060051918029785156  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04686307907104492 |0.04027843475341797 |0.044550538063049316 |0.00013649463653564453 |0.015193343162536621 |0.003931522369384766 |
----------------------------------------------------------pseudo_mini_loss sum 4.790961742401123
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1020885
Number of first layer input nodes during this epoch:  1020885
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.06005144119262695  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

REG start----................................
Convert a graph into a bidirected graph: 0.558 seconds, peak memory: 50.856 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.856 GB
Metis partitioning: 2.567 seconds, peak memory: 51.185 GB
Split the graph: 0.326 seconds
Construct subgraphs: 0.005 seconds
REG metis partition end ----................................
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.06005144119262695  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

connection checking time:  1.5573029518127441
block generation total time  2.0190742015838623
average batch blocks generation time:  0.2523842751979828
pseudo mini batch 0 input nodes size: 131913
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.056438446044921875  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.056438446044921875  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.10558032989501953  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.10576820373535156  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.05487680435180664  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24842, 9: 64, 8: 48, 6: 44, 7: 43, 4: 36, 5: 35, 3: 28, 1: 21, 2: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.05870342254638672  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.05870342254638672  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 1.5030574798583984  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 1.5074667930603027  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.05891609191894531  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

pseudo mini batch 1 input nodes size: 119170
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.055089473724365234  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.055089473724365234  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.09948396682739258  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.09966278076171875  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.05033302307128906  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23061, 8: 131, 7: 128, 6: 121, 4: 115, 9: 105, 5: 99, 2: 72, 3: 65, 1: 55})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.05393409729003906  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.482421875 GB
    Memory Allocated: 0.05393409729003906  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.486328125 GB
    Memory Allocated: 1.4110593795776367  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.486328125 GB
    Memory Allocated: 1.4154682159423828  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.486328125 GB
    Memory Allocated: 0.053719520568847656  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

pseudo mini batch 2 input nodes size: 125344
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.486328125 GB
    Memory Allocated: 0.050118446350097656  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.486328125 GB
    Memory Allocated: 0.050118446350097656  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.486328125 GB
    Memory Allocated: 0.09752082824707031  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.486328125 GB
    Memory Allocated: 0.09770917892456055  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.486328125 GB
    Memory Allocated: 0.05313587188720703  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 25074, 9: 35, 7: 26, 4: 24, 5: 23, 6: 23, 8: 21, 1: 17, 3: 15, 2: 8})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.486328125 GB
    Memory Allocated: 0.05698394775390625  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.486328125 GB
    Memory Allocated: 0.05698394775390625  GigaBytes
Max Memory Allocated: 1.6972408294677734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.516448974609375  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.5208735466003418  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05728912353515625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 3 input nodes size: 119093
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05344104766845703  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05344104766845703  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09783554077148438  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09802436828613281  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05043363571166992  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24753, 8: 82, 7: 77, 9: 76, 6: 75, 5: 71, 4: 50, 3: 47, 2: 35, 1: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05426454544067383  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05426454544067383  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.5036654472351074  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.5080933570861816  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05419301986694336  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 4 input nodes size: 136668
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05036211013793945  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05036211013793945  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10127496719360352  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10145425796508789  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05687093734741211  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23271, 7: 139, 6: 117, 3: 111, 4: 96, 5: 92, 8: 76, 9: 60, 2: 45, 1: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.060491085052490234  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.060491085052490234  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4240450859069824  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.428253173828125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.06044960021972656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 5 input nodes size: 134739
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05682945251464844  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05682945251464844  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10702371597290039  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10720252990722656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.056110382080078125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23153, 7: 167, 9: 137, 6: 105, 4: 97, 8: 86, 5: 83, 3: 72, 2: 30, 1: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.059722900390625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.059722900390625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.421116828918457  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4255032539367676  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.059531211853027344  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 6 input nodes size: 125203
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05591869354248047  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05591869354248047  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10256052017211914  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10273981094360352  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05236673355102539  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23639, 9: 83, 7: 69, 8: 56, 6: 56, 5: 37, 4: 33, 3: 28, 1: 13, 2: 9})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.0560154914855957  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.0560154914855957  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.43096923828125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.435175895690918  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05602741241455078  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 7 input nodes size: 131305
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05237865447998047  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05237865447998047  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10129404067993164  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10147953033447266  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05465841293334961  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24816, 9: 16, 8: 12, 6: 9, 3: 8, 2: 6, 7: 6, 4: 5, 5: 5, 1: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.058457374572753906  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.058457374572753906  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4932503700256348  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4976081848144531  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.0586085319519043  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.0586085319519043  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.0586085319519043  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029638975858688354 |0.002570509910583496 |0.013900995254516602 |0.00011643767356872559 |0.009469360113143921 |0.002520322799682617 |
----------------------------------------------------------pseudo_mini_loss sum 4.727066993713379
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1023435
Number of first layer input nodes during this epoch:  1023435
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.058608055114746094  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

REG start----................................
Convert a graph into a bidirected graph: 0.649 seconds, peak memory: 57.866 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 57.866 GB
Metis partitioning: 2.531 seconds, peak memory: 58.123 GB
Split the graph: 0.445 seconds
Construct subgraphs: 0.010 seconds
REG metis partition end ----................................
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.058608055114746094  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

connection checking time:  1.574113130569458
block generation total time  1.5212433338165283
average batch blocks generation time:  0.19015541672706604
pseudo mini batch 0 input nodes size: 119488
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.054808616638183594  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.054808616638183594  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09964323043823242  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09983110427856445  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.050730228424072266  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24635, 7: 87, 6: 86, 9: 80, 8: 80, 5: 70, 4: 61, 3: 37, 2: 35, 1: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05454540252685547  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05454540252685547  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.5037307739257812  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.5087056159973145  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.054599761962890625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 1 input nodes size: 122410
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05078458786010742  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05078458786010742  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09638595581054688  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09656524658203125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05154275894165039  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23727, 7: 49, 9: 47, 6: 47, 8: 39, 3: 34, 5: 34, 4: 32, 2: 21, 1: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05519533157348633  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05519533157348633  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4318294525146484  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4362406730651855  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.054995059967041016  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 2 input nodes size: 126391
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05134248733520508  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05134248733520508  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09842681884765625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09860563278198242  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.052824974060058594  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23687, 9: 55, 4: 44, 8: 40, 6: 37, 5: 35, 7: 33, 3: 27, 2: 24, 1: 14})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.056471824645996094  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.056471824645996094  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4301142692565918  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.434316635131836  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05646324157714844  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 3 input nodes size: 120595
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05281639099121094  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05281639099121094  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09841775894165039  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09859609603881836  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.051332950592041016  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23069, 8: 128, 7: 118, 6: 110, 9: 105, 4: 95, 5: 93, 3: 65, 2: 62, 1: 51})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05492973327636719  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05492973327636719  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4104642868041992  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4146666526794434  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05491209030151367  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 4 input nodes size: 128989
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.0513153076171875  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.0513153076171875  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09946393966674805  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.09965181350708008  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.053872108459472656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24511, 7: 165, 9: 128, 6: 88, 4: 85, 8: 74, 5: 66, 3: 55, 1: 30, 2: 13})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.057683467864990234  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.057683467864990234  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.5119638442993164  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.5163793563842773  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05791425704956055  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 5 input nodes size: 135084
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05410289764404297  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05410289764404297  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10442590713500977  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.1046133041381836  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.056276798248291016  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 25052, 3: 15, 2: 12, 9: 12, 8: 8, 5: 8, 4: 5, 6: 4, 1: 4, 7: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.06010913848876953  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.06010913848876953  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.5131707191467285  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.5175700187683105  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.060092926025390625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 6 input nodes size: 124573
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05626058578491211  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05626058578491211  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10266780853271484  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10284662246704102  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05233621597290039  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23410, 9: 98, 7: 96, 8: 89, 6: 85, 3: 53, 4: 52, 5: 48, 2: 27, 1: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05596590042114258  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05596590042114258  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4240474700927734  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4284467697143555  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.055765628814697266  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 7 input nodes size: 136442
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05213594436645508  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05213594436645508  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10296487808227539  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10315227508544922  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05656623840332031  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24518, 7: 104, 6: 93, 5: 91, 3: 88, 4: 82, 8: 54, 9: 51, 2: 27, 1: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.0603642463684082  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.0603642463684082  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.5088090896606445  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.5132088661193848  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.06056499481201172  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.06056499481201172  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.06056499481201172  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035460442304611206 |0.0025661885738372803 |0.014540016651153564 |0.0001232624053955078 |0.015803992748260498 |0.001322031021118164 |
----------------------------------------------------------pseudo_mini_loss sum 4.66319465637207
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1013972
Number of first layer input nodes during this epoch:  1013972
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.060564517974853516  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

REG start----................................
Convert a graph into a bidirected graph: 0.603 seconds, peak memory: 58.456 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.456 GB
Metis partitioning: 2.553 seconds, peak memory: 58.456 GB
Split the graph: 0.403 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.060564517974853516  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

connection checking time:  1.5687241554260254
block generation total time  1.5523345470428467
average batch blocks generation time:  0.19404181838035583
block dataloader generation time/epoch 10.44770359992981
pseudo mini batch 0 input nodes size: 130326
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05676603317260742  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05676603317260742  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.1053166389465332  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10549497604370117  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05447864532470703  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23389, 7: 100, 9: 89, 8: 78, 6: 68, 3: 48, 4: 42, 5: 38, 1: 24, 2: 18})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.058100223541259766  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.058100223541259766  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.4227113723754883  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 1.426896095275879  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05841970443725586  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 1 input nodes size: 137303
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.054798126220703125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.054798126220703125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.10594749450683594  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.1061253547668457  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.05739641189575195  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 22919, 7: 184, 9: 158, 6: 133, 3: 111, 4: 102, 8: 95, 5: 88, 2: 39, 1: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.060985565185546875  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.58203125 GB
    Memory Allocated: 0.060985565185546875  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.4122042655944824  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.4163832664489746  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.06044626235961914  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 2 input nodes size: 134703
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05685710906982422  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05685710906982422  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.10703802108764648  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.10722589492797852  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05589866638183594  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24686, 7: 89, 4: 86, 5: 81, 6: 77, 3: 60, 8: 56, 9: 36, 2: 21, 1: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05971384048461914  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05971384048461914  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5077052116394043  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5121173858642578  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05994701385498047  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 3 input nodes size: 130939
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.056131839752197266  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.056131839752197266  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.10491085052490234  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.10509300231933594  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05472421646118164  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24313, 9: 14, 2: 11, 6: 10, 8: 10, 3: 8, 7: 8, 5: 8, 1: 5, 4: 5})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.058444976806640625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.058444976806640625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.4865727424621582  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.491389274597168  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.0583043098449707  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 4 input nodes size: 121175
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05458354949951172  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05458354949951172  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09972476959228516  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09991216659545898  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05095100402832031  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24711, 9: 64, 8: 62, 6: 61, 7: 59, 5: 57, 4: 48, 3: 33, 2: 31, 1: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.054766178131103516  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.054766178131103516  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5014190673828125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5058221817016602  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05489778518676758  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 5 input nodes size: 129986
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.051082611083984375  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.051082611083984375  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09950637817382812  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09969425201416016  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05436563491821289  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 25018, 9: 51, 8: 24, 7: 20, 5: 19, 1: 16, 6: 15, 4: 15, 2: 13, 3: 7})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.058205604553222656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.058205604553222656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5140089988708496  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5184216499328613  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05821514129638672  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 6 input nodes size: 114268
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05437517166137695  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05437517166137695  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09694337844848633  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.0971221923828125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.04851055145263672  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23110, 7: 125, 8: 123, 4: 120, 6: 119, 9: 105, 5: 98, 2: 72, 3: 72, 1: 56})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.052117347717285156  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.052117347717285156  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.4108924865722656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.415095329284668  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05190753936767578  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 7 input nodes size: 129557
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.048300743103027344  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.048300743103027344  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09752941131591797  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09771490097045898  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05496788024902344  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24463, 7: 70, 6: 67, 8: 64, 9: 59, 5: 56, 4: 38, 3: 35, 2: 16, 1: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.058743953704833984  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.058743953704833984  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.501328468322754  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5056862831115723  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05889892578125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05889892578125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05889892578125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029592663049697876 |0.0025884807109832764 |0.014363974332809448 |0.00012177228927612305 |0.011226624250411987 |0.0009791851043701172 |
----------------------------------------------------------pseudo_mini_loss sum 4.599068641662598
Total (block generation + training)time/epoch 10.975918531417847
Training time/epoch 0.5278363227844238
Training time without block to device /epoch 0.5071284770965576
Training time without total dataloading part /epoch 0.20667815208435059
load block tensor time/epoch 0.236741304397583
block to device time/epoch 0.02070784568786621
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1028257
Number of first layer input nodes during this epoch:  1028257
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.0588984489440918  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

REG start----................................
Convert a graph into a bidirected graph: 0.576 seconds, peak memory: 58.456 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.456 GB
Metis partitioning: 2.596 seconds, peak memory: 58.456 GB
Split the graph: 0.519 seconds
Construct subgraphs: 0.025 seconds
REG metis partition end ----................................
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.0588984489440918  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

connection checking time:  1.592733383178711
block generation total time  1.5721797943115234
average batch blocks generation time:  0.19652247428894043
block dataloader generation time/epoch 10.542524814605713
pseudo mini batch 0 input nodes size: 124048
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05512189865112305  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05512189865112305  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.1013336181640625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.10152149200439453  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05210733413696289  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24684, 9: 83, 7: 79, 8: 78, 6: 70, 5: 59, 3: 44, 4: 38, 2: 29, 1: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.055924415588378906  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.055924415588378906  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5049924850463867  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5094022750854492  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05597686767578125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 1 input nodes size: 125818
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.052159786224365234  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.052159786224365234  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09903097152709961  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09921884536743164  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.052819252014160156  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24713, 7: 76, 5: 68, 6: 64, 8: 60, 9: 60, 4: 57, 3: 28, 1: 23, 2: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05663633346557617  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05663633346557617  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5030899047851562  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.507497787475586  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05663490295410156  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 2 input nodes size: 118270
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05281782150268555  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05281782150268555  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09774351119995117  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09792137145996094  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05086231231689453  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23073, 8: 120, 7: 118, 4: 114, 6: 112, 9: 101, 5: 88, 3: 59, 2: 55, 1: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.0544590950012207  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.0544590950012207  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.4098711013793945  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.4142789840698242  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.054230690002441406  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 3 input nodes size: 127967
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.050633907318115234  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.050633907318115234  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09830570220947266  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.09849405288696289  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.0533905029296875  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 25076, 9: 42, 1: 31, 8: 24, 6: 18, 3: 18, 5: 17, 7: 15, 4: 11, 2: 8})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.057236671447753906  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.057236671447753906  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5161466598510742  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.5205702781677246  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.0581202507019043  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 4 input nodes size: 126280
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05427408218383789  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05427408218383789  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.1013174057006836  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.10149717330932617  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.053637027740478516  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23606, 9: 96, 7: 83, 8: 68, 6: 67, 3: 56, 5: 42, 4: 31, 2: 22, 1: 11})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.057290077209472656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.057290077209472656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.432887077331543  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 1.4371042251586914  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05644416809082031  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 5 input nodes size: 135646
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05279111862182617  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05279111862182617  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.10332345962524414  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.10350275039672852  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.056279659271240234  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 22686, 7: 270, 6: 199, 4: 189, 9: 159, 5: 157, 3: 147, 8: 143, 2: 55, 1: 53})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05986738204956055  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.583984375 GB
    Memory Allocated: 0.05986738204956055  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4132819175720215  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.417494773864746  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.060400962829589844  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 6 input nodes size: 139392
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05681324005126953  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05681324005126953  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10874080657958984  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10892105102539062  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05820941925048828  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24080, 9: 22, 4: 12, 8: 12, 5: 11, 6: 11, 7: 10, 3: 7, 2: 5, 1: 5})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06189680099487305  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06189680099487305  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4506335258483887  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.454866886138916  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.061379432678222656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 7 input nodes size: 130888
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05769205093383789  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05769205093383789  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10645198822021484  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10663700103759766  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05452919006347656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24691, 2: 26, 3: 15, 9: 13, 6: 9, 1: 7, 8: 7, 4: 4, 7: 4, 5: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05830860137939453  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05830860137939453  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4913368225097656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.495676040649414  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.058414459228515625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.058414459228515625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.058414459228515625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03617185354232788 |0.0026681125164031982 |0.014739811420440674 |0.00012055039405822754 |0.010896354913711548 |0.00133514404296875 |
----------------------------------------------------------pseudo_mini_loss sum 4.534756660461426
Total (block generation + training)time/epoch 11.102584958076477
Training time/epoch 0.5916364192962646
Training time without block to device /epoch 0.5702915191650391
Training time without total dataloading part /epoch 0.20738887786865234
load block tensor time/epoch 0.28937482833862305
block to device time/epoch 0.021344900131225586
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1028309
Number of first layer input nodes during this epoch:  1028309
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

REG start----................................
Convert a graph into a bidirected graph: 0.591 seconds, peak memory: 58.490 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.490 GB
Metis partitioning: 2.670 seconds, peak memory: 58.490 GB
Split the graph: 0.505 seconds
Construct subgraphs: 0.150 seconds
REG metis partition end ----................................
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05841398239135742  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

connection checking time:  1.5821208953857422
block generation total time  1.5657131671905518
average batch blocks generation time:  0.19571414589881897
block dataloader generation time/epoch 10.616846323013306
pseudo mini batch 0 input nodes size: 131555
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05463409423828125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05463409423828125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10364246368408203  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10383033752441406  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0548853874206543  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 25129, 4: 20, 9: 12, 2: 9, 7: 8, 3: 6, 8: 6, 6: 4, 1: 3, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0587310791015625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0587310791015625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5159687995910645  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5213127136230469  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05921220779418945  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 1 input nodes size: 141896
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05536651611328125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05536651611328125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10822725296020508  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10840559005737305  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059209346771240234  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23819, 9: 19, 4: 14, 2: 11, 7: 9, 1: 6, 5: 6, 3: 6, 8: 6, 6: 6})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06285572052001953  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06285572052001953  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.435997486114502  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4407172203063965  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.062448978424072266  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 2 input nodes size: 130703
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05880260467529297  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05880260467529297  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10749340057373047  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10767221450805664  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.054633140563964844  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 22704, 7: 257, 6: 199, 4: 159, 9: 158, 5: 157, 3: 147, 8: 130, 2: 44, 1: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05821704864501953  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05821704864501953  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4099693298339844  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.414381980895996  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.058005332946777344  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 3 input nodes size: 132117
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.054421424865722656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.054421424865722656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10363912582397461  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10381746292114258  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.054947853088378906  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23366, 9: 108, 7: 100, 8: 79, 6: 73, 3: 57, 5: 50, 4: 42, 1: 24, 2: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05857133865356445  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05857133865356445  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4233183860778809  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4275074005126953  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.058559417724609375  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 4 input nodes size: 119779
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05493593215942383  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05493593215942383  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09955739974975586  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09973669052124023  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05034065246582031  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23484, 7: 84, 5: 75, 6: 73, 8: 72, 4: 56, 9: 55, 3: 41, 2: 38, 1: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.053974151611328125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.053974151611328125  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4227681159973145  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4269709587097168  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.053987979888916016  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 5 input nodes size: 128022
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0503544807434082  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0503544807434082  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09804677963256836  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09823417663574219  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05343341827392578  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24630, 9: 82, 7: 75, 8: 74, 6: 72, 5: 57, 4: 42, 3: 42, 2: 36, 1: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05724287033081055  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05724287033081055  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5047721862792969  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5091753005981445  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05744314193725586  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 6 input nodes size: 125813
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.053633689880371094  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.053633689880371094  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10050296783447266  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10069131851196289  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.052811622619628906  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 25049, 9: 47, 8: 25, 6: 23, 7: 21, 5: 18, 4: 18, 1: 17, 3: 12, 2: 9})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0566558837890625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0566558837890625  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5145440101623535  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5189638137817383  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05667257308959961  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

pseudo mini batch 7 input nodes size: 109820
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.052828311920166016  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.052828311920166016  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09373950958251953  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09392738342285156  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.046869754791259766  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24428, 8: 120, 4: 105, 7: 101, 6: 100, 9: 95, 5: 81, 3: 63, 2: 52, 1: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.050667762756347656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.050667762756347656  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5029973983764648  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5074067115783691  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05065727233886719  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05065727233886719  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05065727233886719  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03582710027694702 |0.0031090080738067627 |0.014118224382400513 |0.00012227892875671387 |0.014376431703567505 |0.001439809799194336 |
----------------------------------------------------------pseudo_mini_loss sum 4.470461845397949
Total (block generation + training)time/epoch 11.193045059839884
Training time/epoch 0.6082332134246826
Training time without block to device /epoch 0.5833611488342285
Training time without total dataloading part /epoch 0.2303752899169922
load block tensor time/epoch 0.28661680221557617
block to device time/epoch 0.0248720645904541
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1019705
Number of first layer input nodes during this epoch:  1019705
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.050656795501708984  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

REG start----................................
Convert a graph into a bidirected graph: 0.571 seconds, peak memory: 58.594 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.594 GB
Metis partitioning: 2.679 seconds, peak memory: 58.594 GB
Split the graph: 0.489 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.050656795501708984  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

connection checking time:  1.5867626667022705
block generation total time  1.5719728469848633
average batch blocks generation time:  0.1964966058731079
block dataloader generation time/epoch 10.626431107521057
pseudo mini batch 0 input nodes size: 132286
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.04685831069946289  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.04685831069946289  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09613895416259766  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09632730484008789  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.055228233337402344  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 25069, 9: 50, 8: 23, 1: 19, 6: 18, 4: 17, 7: 17, 3: 12, 5: 11, 2: 11})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05907440185546875  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05907440185546875  GigaBytes
Max Memory Allocated: 1.6999554634094238  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.51735258102417  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5217742919921875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059087276458740234  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 1 input nodes size: 108402
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05524110794067383  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05524110794067383  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09615230560302734  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09634065628051758  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.04687166213989258  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24488, 8: 121, 4: 110, 6: 108, 7: 104, 9: 98, 5: 88, 3: 60, 2: 46, 1: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05068159103393555  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05068159103393555  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5045843124389648  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5090069770812988  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.050683021545410156  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 2 input nodes size: 120346
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.04687309265136719  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.04687309265136719  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0917057991027832  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09188461303710938  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.050785064697265625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23507, 7: 68, 6: 66, 5: 65, 8: 52, 9: 50, 4: 50, 1: 40, 3: 39, 2: 37})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05441474914550781  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05441474914550781  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4218659400939941  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4260640144348145  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05419015884399414  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 3 input nodes size: 125974
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05056047439575195  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05056047439575195  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09748983383178711  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09767818450927734  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.052666664123535156  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24753, 7: 79, 8: 79, 9: 79, 6: 73, 5: 61, 4: 50, 3: 42, 2: 26, 1: 15})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05649566650390625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05649566650390625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5064506530761719  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.510873794555664  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.056720733642578125  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 4 input nodes size: 128407
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05289173126220703  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05289173126220703  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10072708129882812  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.1009054183959961  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0537877082824707  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23516, 9: 90, 7: 78, 8: 62, 6: 59, 4: 37, 5: 34, 3: 28, 2: 12, 1: 10})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05742073059082031  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05742073059082031  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.426745891571045  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.431169033050537  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.057187557220458984  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 5 input nodes size: 134693
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.053554534912109375  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.053554534912109375  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10373163223266602  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10391807556152344  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.055904388427734375  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24941, 2: 18, 8: 15, 1: 13, 9: 13, 3: 9, 6: 4, 5: 4, 7: 4, 4: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05972099304199219  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05972099304199219  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5080771446228027  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5124592781066895  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05991315841674805  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 6 input nodes size: 130706
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.056096553802490234  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.056096553802490234  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10478878021240234  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10496759414672852  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05460405349731445  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23159, 7: 163, 9: 134, 6: 107, 4: 95, 8: 92, 5: 89, 3: 69, 1: 27, 2: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05821657180786133  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05821657180786133  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4199037551879883  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.424285888671875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0580291748046875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 7 input nodes size: 141993
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.054416656494140625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.054416656494140625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10731363296508789  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10749197006225586  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05862092971801758  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23176, 7: 142, 3: 115, 6: 115, 4: 94, 5: 93, 8: 68, 9: 62, 2: 52, 1: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.062225341796875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.062225341796875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4211249351501465  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.425316333770752  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06310081481933594  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06310081481933594  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06310081481933594  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03489246964454651 |0.0026505589485168457 |0.01463213562965393 |0.00012356042861938477 |0.008804023265838623 |0.0030002593994140625 |
----------------------------------------------------------pseudo_mini_loss sum 4.405716896057129
Total (block generation + training)time/epoch 11.197513341903687
Training time/epoch 0.55544114112854
Training time without block to device /epoch 0.5342366695404053
Training time without total dataloading part /epoch 0.19147801399230957
load block tensor time/epoch 0.27913975715637207
block to device time/epoch 0.021204471588134766
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  1022807
Number of first layer input nodes during this epoch:  1022807
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06310033798217773  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

REG start----................................
Convert a graph into a bidirected graph: 0.562 seconds, peak memory: 58.662 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.662 GB
Metis partitioning: 2.688 seconds, peak memory: 58.662 GB
Split the graph: 0.514 seconds
Construct subgraphs: 0.147 seconds
REG metis partition end ----................................
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06310033798217773  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

connection checking time:  1.5832273960113525
block generation total time  1.5478622913360596
average batch blocks generation time:  0.19348278641700745
block dataloader generation time/epoch 10.64969973564148
pseudo mini batch 0 input nodes size: 118021
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05949544906616211  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05949544906616211  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10346174240112305  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10364007949829102  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05056476593017578  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23098, 8: 125, 7: 119, 6: 111, 9: 99, 4: 91, 5: 88, 3: 59, 2: 57, 1: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.054163455963134766  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.054163455963134766  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4099454879760742  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4141273498535156  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.053809165954589844  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 1 input nodes size: 130511
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05021047592163086  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05021047592163086  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09882974624633789  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09901762008666992  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.054872989654541016  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24980, 9: 49, 4: 34, 3: 30, 6: 25, 2: 23, 8: 20, 7: 17, 1: 13, 5: 9})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.058707237243652344  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.058707237243652344  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.51310396194458  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.51751708984375  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.058405399322509766  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 2 input nodes size: 118610
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05457115173339844  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05457115173339844  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09875726699829102  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09894514083862305  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.050137996673583984  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24721, 7: 63, 6: 61, 5: 57, 9: 56, 8: 55, 4: 52, 3: 37, 1: 31, 2: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05395317077636719  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05395317077636719  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.500455379486084  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.504861831665039  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.054131507873535156  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 3 input nodes size: 125288
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05031633377075195  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05031633377075195  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09699010848999023  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09717798233032227  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.052803993225097656  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24685, 7: 86, 9: 83, 8: 80, 6: 70, 5: 63, 4: 56, 3: 48, 1: 21, 2: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0566248893737793  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0566248893737793  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5063905715942383  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.510805606842041  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05644845962524414  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 4 input nodes size: 127455
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0526275634765625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0526275634765625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10010862350463867  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10028839111328125  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05342674255371094  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23703, 9: 96, 7: 73, 8: 58, 6: 58, 5: 40, 4: 31, 3: 23, 1: 16, 2: 10})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05708932876586914  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05708932876586914  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4364066123962402  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4406285285949707  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.056896209716796875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 5 input nodes size: 136569
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05323362350463867  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05323362350463867  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.1041097640991211  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10429525375366211  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05663442611694336  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24768, 1: 21, 2: 12, 6: 10, 3: 10, 8: 9, 9: 8, 7: 6, 4: 3, 5: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.060423851013183594  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.060423851013183594  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4942140579223633  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.498565673828125  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.060553550720214844  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 6 input nodes size: 133865
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05676412582397461  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05676412582397461  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10663318634033203  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10681343078613281  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.055751800537109375  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23374, 9: 152, 7: 149, 6: 120, 4: 92, 3: 82, 8: 80, 5: 79, 2: 32, 1: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05939912796020508  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05939912796020508  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.433682918548584  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4379191398620605  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05982398986816406  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 7 input nodes size: 133306
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05617666244506836  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05617666244506836  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10583734512329102  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10601615905761719  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.055966854095458984  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23280, 7: 142, 5: 106, 4: 97, 6: 95, 3: 85, 8: 85, 2: 37, 9: 33, 1: 10})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059583187103271484  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059583187103271484  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4216299057006836  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4264063835144043  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059381961822509766  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059381961822509766  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059381961822509766  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03488504886627197 |0.0028457045555114746 |0.014120608568191528 |0.00011578202247619629 |0.010999888181686401 |0.0028734207153320312 |
----------------------------------------------------------pseudo_mini_loss sum 4.338759899139404
Total (block generation + training)time/epoch 11.220912218093872
Training time/epoch 0.5715253353118896
Training time without block to device /epoch 0.5487596988677979
Training time without total dataloading part /epoch 0.20476365089416504
load block tensor time/epoch 0.2790803909301758
block to device time/epoch 0.022765636444091797
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  1023625
Number of first layer input nodes during this epoch:  1023625
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05938148498535156  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

REG start----................................
Convert a graph into a bidirected graph: 0.577 seconds, peak memory: 58.715 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.715 GB
Metis partitioning: 2.688 seconds, peak memory: 58.715 GB
Split the graph: 0.493 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05938148498535156  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

connection checking time:  1.5713398456573486
block generation total time  1.5588085651397705
average batch blocks generation time:  0.1948510706424713
block dataloader generation time/epoch 10.649667104085287
pseudo mini batch 0 input nodes size: 122942
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05576467514038086  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05576467514038086  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10156440734863281  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.1017446517944336  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.051905155181884766  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23689, 7: 88, 9: 86, 8: 69, 6: 63, 4: 48, 1: 37, 5: 36, 3: 24, 2: 15})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05556774139404297  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05556774139404297  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4354491233825684  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4400248527526855  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05543708801269531  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 1 input nodes size: 105877
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05177450180053711  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05177450180053711  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.091217041015625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09139871597290039  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.045418739318847656  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23605, 8: 120, 6: 110, 4: 109, 7: 108, 9: 91, 5: 90, 2: 57, 3: 57, 1: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.04909372329711914  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.04909372329711914  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4338903427124023  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4381589889526367  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.048918724060058594  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 2 input nodes size: 123906
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.04524374008178711  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.04524374008178711  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09140253067016602  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09159040451049805  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.051966190338134766  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24685, 7: 83, 8: 78, 9: 77, 6: 70, 5: 68, 4: 53, 3: 41, 2: 24, 1: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.055785179138183594  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.055785179138183594  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5043830871582031  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5087952613830566  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.055928707122802734  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 3 input nodes size: 115504
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.052109718322753906  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.052109718322753906  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0951385498046875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0953216552734375  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.04897499084472656  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24106, 7: 69, 6: 67, 8: 61, 9: 59, 5: 58, 4: 48, 3: 33, 2: 29, 1: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05269813537597656  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05269813537597656  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4558138847351074  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.460113525390625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.052585601806640625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 4 input nodes size: 146157
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.048862457275390625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.048862457275390625  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10331058502197266  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10349798202514648  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06028604507446289  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24995, 9: 26, 2: 18, 5: 14, 8: 13, 7: 12, 3: 11, 4: 11, 6: 10, 1: 7})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06411457061767578  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06411457061767578  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5168275833129883  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.521225929260254  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06421327590942383  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 5 input nodes size: 132703
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06038475036621094  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06038475036621094  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10982084274291992  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.11000871658325195  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.055373191833496094  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 25124, 9: 14, 6: 11, 2: 11, 3: 10, 5: 6, 8: 4, 1: 4, 4: 3, 7: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059216976165771484  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059216976165771484  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5165166854858398  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.520927906036377  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059459686279296875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 6 input nodes size: 139268
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.055615901947021484  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.055615901947021484  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.1074976921081543  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10767650604248047  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05805253982543945  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23184, 7: 164, 9: 160, 6: 97, 8: 90, 4: 88, 3: 80, 5: 77, 1: 37, 2: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.061670780181884766  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.061670780181884766  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.424910068511963  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4291129112243652  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06154584884643555  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 7 input nodes size: 136004
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.057927608489990234  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.057927608489990234  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10859346389770508  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10877227783203125  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.056711673736572266  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23221, 7: 129, 6: 122, 3: 118, 4: 96, 5: 96, 8: 77, 9: 63, 2: 44, 1: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06032419204711914  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06032419204711914  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4214677810668945  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4256682395935059  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.060544490814208984  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.060544490814208984  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.060544490814208984  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03443905711174011 |0.0029568076133728027 |0.014187604188919067 |0.00011897087097167969 |0.00985872745513916 |0.002418041229248047 |
----------------------------------------------------------pseudo_mini_loss sum 4.269878387451172
Total (block generation + training)time/epoch 11.218932708104452
Training time/epoch 0.5592639446258545
Training time without block to device /epoch 0.5356094837188721
Training time without total dataloading part /epoch 0.1957404613494873
load block tensor time/epoch 0.2755124568939209
block to device time/epoch 0.023654460906982422
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  1022361
Number of first layer input nodes during this epoch:  1022361
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06054401397705078  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

REG start----................................
Convert a graph into a bidirected graph: 0.583 seconds, peak memory: 58.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.730 GB
Metis partitioning: 2.659 seconds, peak memory: 58.730 GB
Split the graph: 0.466 seconds
Construct subgraphs: 0.131 seconds
REG metis partition end ----................................
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06054401397705078  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

connection checking time:  1.576385498046875
block generation total time  1.5321180820465088
average batch blocks generation time:  0.1915147602558136
block dataloader generation time/epoch 10.644922801426478
pseudo mini batch 0 input nodes size: 119604
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0569310188293457  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0569310188293457  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.1014871597290039  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10166692733764648  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05082225799560547  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23549, 7: 96, 9: 94, 8: 85, 6: 79, 4: 64, 5: 60, 3: 40, 2: 30, 1: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0544734001159668  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0544734001159668  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.429593563079834  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4343304634094238  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05410146713256836  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 1 input nodes size: 124564
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05045032501220703  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05045032501220703  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09769105911254883  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09787893295288086  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05314302444458008  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24647, 7: 87, 6: 86, 9: 85, 8: 84, 5: 67, 4: 58, 3: 42, 2: 28, 1: 15})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.056960105895996094  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.056960105895996094  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.506535530090332  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5109481811523438  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.057009220123291016  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 2 input nodes size: 105358
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.053192138671875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.053192138671875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09244108200073242  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0926213264465332  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.045192718505859375  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23409, 8: 120, 6: 114, 7: 110, 4: 108, 9: 97, 5: 85, 3: 64, 2: 51, 1: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.048838138580322266  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.048838138580322266  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4222354888916016  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.42647123336792  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.048661231994628906  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 3 input nodes size: 121433
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.045015811920166016  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.045015811920166016  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09025335311889648  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.09043550491333008  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.051006317138671875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24122, 9: 60, 7: 41, 6: 34, 1: 34, 5: 34, 8: 33, 4: 28, 3: 26, 2: 15})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0547175407409668  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0547175407409668  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4532556533813477  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.457533359527588  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05475950241088867  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 4 input nodes size: 133467
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05104827880859375  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05104827880859375  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10076904296875  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10095691680908203  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05553722381591797  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 25146, 9: 15, 8: 8, 6: 8, 3: 8, 1: 6, 4: 5, 7: 4, 5: 4, 2: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059384822845458984  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.059384822845458984  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5168805122375488  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5212945938110352  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05952119827270508  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 5 input nodes size: 138076
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05567359924316406  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05567359924316406  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10711097717285156  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10729789733886719  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.057389259338378906  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24410, 7: 109, 6: 88, 5: 87, 4: 86, 8: 79, 3: 74, 9: 47, 2: 35, 1: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.061171531677246094  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.061171531677246094  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.508641242980957  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.5130252838134766  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.0611414909362793  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 6 input nodes size: 136414
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05735921859741211  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05735921859741211  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10817766189575195  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10835647583007812  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.056732177734375  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 23148, 7: 173, 9: 133, 6: 117, 4: 93, 3: 88, 8: 88, 5: 86, 2: 45, 1: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06034660339355469  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06034660339355469  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.423255443572998  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4274582862854004  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.06070137023925781  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

pseudo mini batch 7 input nodes size: 129358
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.057086944580078125  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.057086944580078125  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10527658462524414  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.10545873641967773  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05446147918701172  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({10: 24178, 9: 45, 7: 35, 3: 32, 6: 24, 5: 22, 8: 15, 2: 14, 4: 14, 1: 13})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05817461013793945  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05817461013793945  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4564228057861328  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 1.4606943130493164  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05770730972290039  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05770730972290039  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.59765625 GB
    Memory Allocated: 0.05770730972290039  GigaBytes
Max Memory Allocated: 1.7011260986328125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03724589943885803 |0.0031506717205047607 |0.013996601104736328 |0.00011599063873291016 |0.012432605028152466 |0.0029561519622802734 |
----------------------------------------------------------pseudo_mini_loss sum 4.198760509490967
Total (block generation + training)time/epoch 11.220567294529506
Training time/epoch 0.6136324405670166
Training time without block to device /epoch 0.5884270668029785
Training time without total dataloading part /epoch 0.2153177261352539
load block tensor time/epoch 0.29796719551086426
block to device time/epoch 0.025205373764038086
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  1008274
Number of first layer input nodes during this epoch:  1008274
Number of first layer output nodes during this epoch:  196571
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  90200
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([47, 100])
layers.0.fc_neigh.weight, torch.Size([47, 100])
----------------------------------------
un-trainable parameters
